<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OCR-Lezcollitade: src/network/network.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">OCR-Lezcollitade
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_fc4c7f03e1a69a98c370fae55a743828.html">network</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">network.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;err.h&gt;</code><br />
<code>#include &lt;malloc.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &quot;<a class="el" href="network_8h_source.html">network.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="function_8h_source.html">function.h</a>&quot;</code><br />
</div>
<p><a href="network_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a28a631a46550a13bbf48635953aafcbd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#a28a631a46550a13bbf48635953aafcbd">CHK</a>(ptr,  function,  message)</td></tr>
<tr class="memdesc:a28a631a46550a13bbf48635953aafcbd"><td class="mdescLeft">&#160;</td><td class="mdescRight">checks if a pointer is null.  <a href="network_8c.html#a28a631a46550a13bbf48635953aafcbd">More...</a><br /></td></tr>
<tr class="separator:a28a631a46550a13bbf48635953aafcbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd607f13447d238cfa36348ed8e5d383"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#abd607f13447d238cfa36348ed8e5d383">READ_LENGTH</a>&#160;&#160;&#160;1024</td></tr>
<tr class="separator:abd607f13447d238cfa36348ed8e5d383"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4ddc3e0dbc1979105df3cb54aea54319"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmatrix__t.html">matrix_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#a4ddc3e0dbc1979105df3cb54aea54319">compute_layer</a> (<a class="el" href="structmatrix__t.html">matrix_t</a> *values, <a class="el" href="structlayer__t.html">layer_t</a> *layer, <a class="el" href="matrix_8h.html#af967065ada73d6d2c06c01459e274435">mat_transform_t</a> <a class="el" href="function_8h.html#a312ab1be52b156fb23e9345424c0f2b9">activation</a>)</td></tr>
<tr class="separator:a4ddc3e0dbc1979105df3cb54aea54319"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49d5f5101cda3ffc8355a0237ee16709"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structmatrix__t.html">matrix_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#a49d5f5101cda3ffc8355a0237ee16709">compute_result</a> (<a class="el" href="structmatrix__t.html">matrix_t</a> *values, <a class="el" href="structnetwork__t.html">network_t</a> *network)</td></tr>
<tr class="memdesc:a49d5f5101cda3ffc8355a0237ee16709"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the result of the input by the network.  <a href="network_8c.html#a49d5f5101cda3ffc8355a0237ee16709">More...</a><br /></td></tr>
<tr class="separator:a49d5f5101cda3ffc8355a0237ee16709"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab872ac733c73ac5b412e9da46426a3ad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#ab872ac733c73ac5b412e9da46426a3ad">compute_result_with_save</a> (<a class="el" href="structmatrix__t.html">matrix_t</a> **values, <a class="el" href="structnetwork__t.html">network_t</a> *network)</td></tr>
<tr class="separator:ab872ac733c73ac5b412e9da46426a3ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa706a2634d39e1b59182ab9a9403931c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structneuron__t.html">neuron_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#aa706a2634d39e1b59182ab9a9403931c">neuron_create</a> (<a class="el" href="structmatrix__t.html">matrix_t</a> *weights, double bias)</td></tr>
<tr class="memdesc:aa706a2634d39e1b59182ab9a9403931c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a neuron.  <a href="network_8c.html#aa706a2634d39e1b59182ab9a9403931c">More...</a><br /></td></tr>
<tr class="separator:aa706a2634d39e1b59182ab9a9403931c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a634adde351458c2e8f8825c1816eeb43"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#a634adde351458c2e8f8825c1816eeb43">neuron_free</a> (<a class="el" href="structneuron__t.html">neuron_t</a> *neuron)</td></tr>
<tr class="memdesc:a634adde351458c2e8f8825c1816eeb43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees the allocated neuron.  <a href="network_8c.html#a634adde351458c2e8f8825c1816eeb43">More...</a><br /></td></tr>
<tr class="separator:a634adde351458c2e8f8825c1816eeb43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb61905641c2a84fe9cd88fb04672361"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structlayer__t.html">layer_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#adb61905641c2a84fe9cd88fb04672361">layer_create_from_mat</a> (<a class="el" href="structmatrix__t.html">matrix_t</a> **weights, double *biases, size_t count)</td></tr>
<tr class="memdesc:adb61905641c2a84fe9cd88fb04672361"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates filled layer from an array of weights, and an array of biases.  <a href="network_8c.html#adb61905641c2a84fe9cd88fb04672361">More...</a><br /></td></tr>
<tr class="separator:adb61905641c2a84fe9cd88fb04672361"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad534d5135c47b2ae4f4637ddcde85205"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structlayer__t.html">layer_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#ad534d5135c47b2ae4f4637ddcde85205">layer_create</a> (<a class="el" href="structneuron__t.html">neuron_t</a> **neurons, size_t count)</td></tr>
<tr class="memdesc:ad534d5135c47b2ae4f4637ddcde85205"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a layer from an array of neurons.  <a href="network_8c.html#ad534d5135c47b2ae4f4637ddcde85205">More...</a><br /></td></tr>
<tr class="separator:ad534d5135c47b2ae4f4637ddcde85205"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0e36ece7ab68f5333223ea9167938d9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#ac0e36ece7ab68f5333223ea9167938d9">layer_free</a> (<a class="el" href="structlayer__t.html">layer_t</a> *layer)</td></tr>
<tr class="memdesc:ac0e36ece7ab68f5333223ea9167938d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees an allocated layer.  <a href="network_8c.html#ac0e36ece7ab68f5333223ea9167938d9">More...</a><br /></td></tr>
<tr class="separator:ac0e36ece7ab68f5333223ea9167938d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7ec187320facb456542975fd39de56e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structnetwork__t.html">network_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#ad7ec187320facb456542975fd39de56e">network_create</a> (<a class="el" href="structlayer__t.html">layer_t</a> **layers, size_t layer_count, size_t inputs)</td></tr>
<tr class="memdesc:ad7ec187320facb456542975fd39de56e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a network from an array of layers.  <a href="network_8c.html#ad7ec187320facb456542975fd39de56e">More...</a><br /></td></tr>
<tr class="separator:ad7ec187320facb456542975fd39de56e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7de60cd0ad5a69e135b63d264018d1a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#ab7de60cd0ad5a69e135b63d264018d1a">network_free</a> (<a class="el" href="structnetwork__t.html">network_t</a> *net)</td></tr>
<tr class="memdesc:ab7de60cd0ad5a69e135b63d264018d1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees the allocated network.  <a href="network_8c.html#ab7de60cd0ad5a69e135b63d264018d1a">More...</a><br /></td></tr>
<tr class="separator:ab7de60cd0ad5a69e135b63d264018d1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71f0aa4f7efea3ff158a49342228bb80"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structnetwork__t.html">network_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#a71f0aa4f7efea3ff158a49342228bb80">network_load</a> (const char *path)</td></tr>
<tr class="memdesc:a71f0aa4f7efea3ff158a49342228bb80"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loads the network from a file.  <a href="network_8c.html#a71f0aa4f7efea3ff158a49342228bb80">More...</a><br /></td></tr>
<tr class="separator:a71f0aa4f7efea3ff158a49342228bb80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee995127aad46272ae3ddc5dfef07edc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#aee995127aad46272ae3ddc5dfef07edc">network_save</a> (const char *path, <a class="el" href="structnetwork__t.html">network_t</a> *net)</td></tr>
<tr class="memdesc:aee995127aad46272ae3ddc5dfef07edc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Saves a network to a file.  <a href="network_8c.html#aee995127aad46272ae3ddc5dfef07edc">More...</a><br /></td></tr>
<tr class="separator:aee995127aad46272ae3ddc5dfef07edc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba00189ea608835915fdd9f753c33fd4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structnetwork__t.html">network_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#aba00189ea608835915fdd9f753c33fd4">network_generate</a> (size_t *neuron_count, size_t size)</td></tr>
<tr class="memdesc:aba00189ea608835915fdd9f753c33fd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a network based on given neuron count.  <a href="network_8c.html#aba00189ea608835915fdd9f753c33fd4">More...</a><br /></td></tr>
<tr class="separator:aba00189ea608835915fdd9f753c33fd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abef62369a77da828529fbf193f111ef7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structnetwork__t.html">network_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#abef62369a77da828529fbf193f111ef7">network_copy</a> (<a class="el" href="structnetwork__t.html">network_t</a> *old)</td></tr>
<tr class="memdesc:abef62369a77da828529fbf193f111ef7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a deep copied network.  <a href="network_8c.html#abef62369a77da828529fbf193f111ef7">More...</a><br /></td></tr>
<tr class="separator:abef62369a77da828529fbf193f111ef7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac99789abdffa9915778914a50c1b4514"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#ac99789abdffa9915778914a50c1b4514">network_train</a> (<a class="el" href="structnetwork__t.html">network_t</a> **pnet, <a class="el" href="structmatrix__t.html">matrix_t</a> *inputs, <a class="el" href="structmatrix__t.html">matrix_t</a> *target, double rate)</td></tr>
<tr class="separator:ac99789abdffa9915778914a50c1b4514"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a338eaca7b062c45c2ddf651ec7bfb5ab"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="network_8c.html#a338eaca7b062c45c2ddf651ec7bfb5ab">network_get_output</a> (<a class="el" href="structmatrix__t.html">matrix_t</a> *outputs, double threshold)</td></tr>
<tr class="memdesc:a338eaca7b062c45c2ddf651ec7bfb5ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the calculated output.  <a href="network_8c.html#a338eaca7b062c45c2ddf651ec7bfb5ab">More...</a><br /></td></tr>
<tr class="separator:a338eaca7b062c45c2ddf651ec7bfb5ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a28a631a46550a13bbf48635953aafcbd" name="a28a631a46550a13bbf48635953aafcbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28a631a46550a13bbf48635953aafcbd">&#9670;&nbsp;</a></span>CHK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CHK</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">ptr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">function, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">message&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    {                                             \</div>
<div class="line">        if (ptr == NULL)                          \</div>
<div class="line">            errx(1, <span class="stringliteral">&quot;%s: %s&quot;</span>, function, message); \</div>
<div class="line">    }</div>
</div><!-- fragment -->
<p>checks if a pointer is null. </p>

<p class="definition">Definition at line <a class="el" href="network_8c_source.html#l00008">8</a> of file <a class="el" href="network_8c_source.html">network.c</a>.</p>

</div>
</div>
<a id="abd607f13447d238cfa36348ed8e5d383" name="abd607f13447d238cfa36348ed8e5d383"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd607f13447d238cfa36348ed8e5d383">&#9670;&nbsp;</a></span>READ_LENGTH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define READ_LENGTH&#160;&#160;&#160;1024</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="network_8c_source.html#l00141">141</a> of file <a class="el" href="network_8c_source.html">network.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a4ddc3e0dbc1979105df3cb54aea54319" name="a4ddc3e0dbc1979105df3cb54aea54319"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ddc3e0dbc1979105df3cb54aea54319">&#9670;&nbsp;</a></span>compute_layer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmatrix__t.html">matrix_t</a> * compute_layer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmatrix__t.html">matrix_t</a> *&#160;</td>
          <td class="paramname"><em>values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlayer__t.html">layer_t</a> *&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="matrix_8h.html#af967065ada73d6d2c06c01459e274435">mat_transform_t</a>&#160;</td>
          <td class="paramname"><em>activation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="network_8c_source.html#l00014">14</a> of file <a class="el" href="network_8c_source.html">network.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   16</span>{</div>
<div class="line"><span class="lineno">   17</span>    <a class="code hl_struct" href="structmatrix__t.html">matrix_t</a> *result = <a class="code hl_function" href="matrix_8c.html#a1d9b061fc8856e727f014c3266b7431d">matrix_create</a>(layer-&gt;<a class="code hl_variable" href="structlayer__t.html#a79cee7069a84d7440d56779ba2c073fb">count</a>, 1, 0);</div>
<div class="line"><span class="lineno">   18</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; layer-&gt;<a class="code hl_variable" href="structlayer__t.html#a79cee7069a84d7440d56779ba2c073fb">count</a>; i++)</div>
<div class="line"><span class="lineno">   19</span>    {</div>
<div class="line"><span class="lineno">   20</span>        <a class="code hl_struct" href="structneuron__t.html">neuron_t</a> *neuron = layer-&gt;<a class="code hl_variable" href="structlayer__t.html#a71e4f1a74c73f54b7ff2c40dc88c795e">neurons</a>[i];</div>
<div class="line"><span class="lineno">   21</span>        <a class="code hl_struct" href="structmatrix__t.html">matrix_t</a> *tmp = <a class="code hl_function" href="matrix_8c.html#aec843b4f924ae1c524b4f3e3dcc0ceda">mat_product</a>(neuron-&gt;<a class="code hl_variable" href="structneuron__t.html#a6182effa3a478564d7dcd7f9d856c029">weights</a>, values);</div>
<div class="line"><span class="lineno">   22</span>        <span class="keywordtype">double</span> postres = <a class="code hl_function" href="matrix_8c.html#a631ff21351ba5ec31350fb5277605d3b">mat_el_at</a>(tmp, 0, 0) + neuron-&gt;<a class="code hl_variable" href="structneuron__t.html#ad82dab1b1a60940e62e80270ad99a522">bias</a>;</div>
<div class="line"><span class="lineno">   23</span>        postres = <a class="code hl_function" href="function_8c.html#a312ab1be52b156fb23e9345424c0f2b9">activation</a>(postres);</div>
<div class="line"><span class="lineno">   24</span>        <a class="code hl_function" href="matrix_8c.html#aa20fd2a5c773eda620ce98e2f121b687">matrix_free</a>(tmp);</div>
<div class="line"><span class="lineno">   25</span>        <a class="code hl_function" href="matrix_8c.html#a0e411263cdaaa67eae166d067996f5b6">mat_set_el</a>(result, i, 0, postres);</div>
<div class="line"><span class="lineno">   26</span>    }</div>
<div class="line"><span class="lineno">   27</span> </div>
<div class="line"><span class="lineno">   28</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">   29</span>}</div>
<div class="ttc" id="afunction_8c_html_a312ab1be52b156fb23e9345424c0f2b9"><div class="ttname"><a href="function_8c.html#a312ab1be52b156fb23e9345424c0f2b9">activation</a></div><div class="ttdeci">double activation(double arg)</div><div class="ttdef"><b>Definition:</b> <a href="function_8c_source.html#l00024">function.c:24</a></div></div>
<div class="ttc" id="amatrix_8c_html_a0e411263cdaaa67eae166d067996f5b6"><div class="ttname"><a href="matrix_8c.html#a0e411263cdaaa67eae166d067996f5b6">mat_set_el</a></div><div class="ttdeci">void mat_set_el(matrix_t *mat, size_t i, size_t j, double value)</div><div class="ttdef"><b>Definition:</b> <a href="matrix_8c_source.html#l00012">matrix.c:12</a></div></div>
<div class="ttc" id="amatrix_8c_html_a1d9b061fc8856e727f014c3266b7431d"><div class="ttname"><a href="matrix_8c.html#a1d9b061fc8856e727f014c3266b7431d">matrix_create</a></div><div class="ttdeci">matrix_t * matrix_create(size_t rows, size_t columns, int fill)</div><div class="ttdef"><b>Definition:</b> <a href="matrix_8c_source.html#l00018">matrix.c:18</a></div></div>
<div class="ttc" id="amatrix_8c_html_a631ff21351ba5ec31350fb5277605d3b"><div class="ttname"><a href="matrix_8c.html#a631ff21351ba5ec31350fb5277605d3b">mat_el_at</a></div><div class="ttdeci">double mat_el_at(matrix_t *mat, size_t i, size_t j)</div><div class="ttdoc">gets the elements at position i, j</div><div class="ttdef"><b>Definition:</b> <a href="matrix_8c_source.html#l00006">matrix.c:6</a></div></div>
<div class="ttc" id="amatrix_8c_html_aa20fd2a5c773eda620ce98e2f121b687"><div class="ttname"><a href="matrix_8c.html#aa20fd2a5c773eda620ce98e2f121b687">matrix_free</a></div><div class="ttdeci">void matrix_free(matrix_t *mat)</div><div class="ttdoc">frees the matrix</div><div class="ttdef"><b>Definition:</b> <a href="matrix_8c_source.html#l00045">matrix.c:45</a></div></div>
<div class="ttc" id="amatrix_8c_html_aec843b4f924ae1c524b4f3e3dcc0ceda"><div class="ttname"><a href="matrix_8c.html#aec843b4f924ae1c524b4f3e3dcc0ceda">mat_product</a></div><div class="ttdeci">matrix_t * mat_product(matrix_t *A, matrix_t *B)</div><div class="ttdoc">Performs the dot product on 2 matrix_t structures.</div><div class="ttdef"><b>Definition:</b> <a href="matrix_8c_source.html#l00051">matrix.c:51</a></div></div>
<div class="ttc" id="astructlayer__t_html_a71e4f1a74c73f54b7ff2c40dc88c795e"><div class="ttname"><a href="structlayer__t.html#a71e4f1a74c73f54b7ff2c40dc88c795e">layer_t::neurons</a></div><div class="ttdeci">neuron_t ** neurons</div><div class="ttdef"><b>Definition:</b> <a href="network_8h_source.html#l00038">network.h:38</a></div></div>
<div class="ttc" id="astructlayer__t_html_a79cee7069a84d7440d56779ba2c073fb"><div class="ttname"><a href="structlayer__t.html#a79cee7069a84d7440d56779ba2c073fb">layer_t::count</a></div><div class="ttdeci">size_t count</div><div class="ttdef"><b>Definition:</b> <a href="network_8h_source.html#l00039">network.h:39</a></div></div>
<div class="ttc" id="astructmatrix__t_html"><div class="ttname"><a href="structmatrix__t.html">matrix_t</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix_8h_source.html#l00009">matrix.h:10</a></div></div>
<div class="ttc" id="astructneuron__t_html"><div class="ttname"><a href="structneuron__t.html">neuron_t</a></div><div class="ttdoc">A struct representing a neuron in the network.</div><div class="ttdef"><b>Definition:</b> <a href="network_8h_source.html#l00009">network.h:10</a></div></div>
<div class="ttc" id="astructneuron__t_html_a6182effa3a478564d7dcd7f9d856c029"><div class="ttname"><a href="structneuron__t.html#a6182effa3a478564d7dcd7f9d856c029">neuron_t::weights</a></div><div class="ttdeci">matrix_t * weights</div><div class="ttdef"><b>Definition:</b> <a href="network_8h_source.html#l00011">network.h:11</a></div></div>
<div class="ttc" id="astructneuron__t_html_ad82dab1b1a60940e62e80270ad99a522"><div class="ttname"><a href="structneuron__t.html#ad82dab1b1a60940e62e80270ad99a522">neuron_t::bias</a></div><div class="ttdeci">double bias</div><div class="ttdef"><b>Definition:</b> <a href="network_8h_source.html#l00013">network.h:13</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a49d5f5101cda3ffc8355a0237ee16709" name="a49d5f5101cda3ffc8355a0237ee16709"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49d5f5101cda3ffc8355a0237ee16709">&#9670;&nbsp;</a></span>compute_result()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structmatrix__t.html">matrix_t</a> * compute_result </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmatrix__t.html">matrix_t</a> *&#160;</td>
          <td class="paramname"><em>inputs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structnetwork__t.html">network_t</a> *&#160;</td>
          <td class="paramname"><em>network</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the result of the input by the network. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">inputs</td><td>The column vector of the values. </td></tr>
    <tr><td class="paramname">network</td><td>The network to apply the values to. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The column vector of the computed results. </dd></dl>

<p class="definition">Definition at line <a class="el" href="network_8c_source.html#l00031">31</a> of file <a class="el" href="network_8c_source.html">network.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   32</span>{</div>
<div class="line"><span class="lineno">   33</span>    <a class="code hl_struct" href="structmatrix__t.html">matrix_t</a> *lastResults = <a class="code hl_function" href="matrix_8c.html#ad4970f9c83f185813ab569266c4fd0de">mat_copy</a>(values);</div>
<div class="line"><span class="lineno">   34</span>    <span class="keywordtype">size_t</span> i;</div>
<div class="line"><span class="lineno">   35</span>    <span class="keywordflow">for</span> (i = 0; i &lt; network-&gt;<a class="code hl_variable" href="structnetwork__t.html#ad5fc71e5df50072d2c5a9ebfb28c7636">layer_count</a> - 1; i++)</div>
<div class="line"><span class="lineno">   36</span>    {</div>
<div class="line"><span class="lineno">   37</span>        <a class="code hl_struct" href="structlayer__t.html">layer_t</a> *layer = network-&gt;<a class="code hl_variable" href="structnetwork__t.html#abc9801a33bc441d67a87fac3b603ae87">layers</a>[i];</div>
<div class="line"><span class="lineno">   38</span>        <a class="code hl_struct" href="structmatrix__t.html">matrix_t</a> *tmp = <a class="code hl_function" href="network_8c.html#a4ddc3e0dbc1979105df3cb54aea54319">compute_layer</a>(lastResults, layer, <a class="code hl_function" href="function_8c.html#a312ab1be52b156fb23e9345424c0f2b9">activation</a>);</div>
<div class="line"><span class="lineno">   39</span>        <a class="code hl_function" href="matrix_8c.html#aa20fd2a5c773eda620ce98e2f121b687">matrix_free</a>(lastResults);</div>
<div class="line"><span class="lineno">   40</span>        lastResults = tmp;</div>
<div class="line"><span class="lineno">   41</span>    }</div>
<div class="line"><span class="lineno">   42</span> </div>
<div class="line"><span class="lineno">   43</span>    <a class="code hl_struct" href="structlayer__t.html">layer_t</a> *layer = network-&gt;<a class="code hl_variable" href="structnetwork__t.html#abc9801a33bc441d67a87fac3b603ae87">layers</a>[i];</div>
<div class="line"><span class="lineno">   44</span>    <a class="code hl_struct" href="structmatrix__t.html">matrix_t</a> *tmp = <a class="code hl_function" href="network_8c.html#a4ddc3e0dbc1979105df3cb54aea54319">compute_layer</a>(lastResults, layer, <a class="code hl_function" href="function_8c.html#a4d12a97f68909050581df67de609d271">output_activation</a>);</div>
<div class="line"><span class="lineno">   45</span>    <a class="code hl_function" href="matrix_8c.html#aa20fd2a5c773eda620ce98e2f121b687">matrix_free</a>(lastResults);</div>
<div class="line"><span class="lineno">   46</span>    lastResults = tmp;</div>
<div class="line"><span class="lineno">   47</span> </div>
<div class="line"><span class="lineno">   48</span>    <span class="keywordflow">return</span> lastResults;</div>
<div class="line"><span class="lineno">   49</span>}</div>
<div class="ttc" id="afunction_8c_html_a4d12a97f68909050581df67de609d271"><div class="ttname"><a href="function_8c.html#a4d12a97f68909050581df67de609d271">output_activation</a></div><div class="ttdeci">double output_activation(double arg)</div><div class="ttdef"><b>Definition:</b> <a href="function_8c_source.html#l00015">function.c:15</a></div></div>
<div class="ttc" id="amatrix_8c_html_ad4970f9c83f185813ab569266c4fd0de"><div class="ttname"><a href="matrix_8c.html#ad4970f9c83f185813ab569266c4fd0de">mat_copy</a></div><div class="ttdeci">matrix_t * mat_copy(matrix_t *origin)</div><div class="ttdoc">Copies the matrix.</div><div class="ttdef"><b>Definition:</b> <a href="matrix_8c_source.html#l00193">matrix.c:193</a></div></div>
<div class="ttc" id="anetwork_8c_html_a4ddc3e0dbc1979105df3cb54aea54319"><div class="ttname"><a href="network_8c.html#a4ddc3e0dbc1979105df3cb54aea54319">compute_layer</a></div><div class="ttdeci">matrix_t * compute_layer(matrix_t *values, layer_t *layer, mat_transform_t activation)</div><div class="ttdef"><b>Definition:</b> <a href="network_8c_source.html#l00014">network.c:14</a></div></div>
<div class="ttc" id="astructlayer__t_html"><div class="ttname"><a href="structlayer__t.html">layer_t</a></div><div class="ttdoc">A struct representing a layer in the network.</div><div class="ttdef"><b>Definition:</b> <a href="network_8h_source.html#l00036">network.h:37</a></div></div>
<div class="ttc" id="astructnetwork__t_html_abc9801a33bc441d67a87fac3b603ae87"><div class="ttname"><a href="structnetwork__t.html#abc9801a33bc441d67a87fac3b603ae87">network_t::layers</a></div><div class="ttdeci">layer_t ** layers</div><div class="ttdef"><b>Definition:</b> <a href="network_8h_source.html#l00081">network.h:81</a></div></div>
<div class="ttc" id="astructnetwork__t_html_ad5fc71e5df50072d2c5a9ebfb28c7636"><div class="ttname"><a href="structnetwork__t.html#ad5fc71e5df50072d2c5a9ebfb28c7636">network_t::layer_count</a></div><div class="ttdeci">size_t layer_count</div><div class="ttdef"><b>Definition:</b> <a href="network_8h_source.html#l00082">network.h:82</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab872ac733c73ac5b412e9da46426a3ad" name="ab872ac733c73ac5b412e9da46426a3ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab872ac733c73ac5b412e9da46426a3ad">&#9670;&nbsp;</a></span>compute_result_with_save()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compute_result_with_save </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmatrix__t.html">matrix_t</a> **&#160;</td>
          <td class="paramname"><em>values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structnetwork__t.html">network_t</a> *&#160;</td>
          <td class="paramname"><em>network</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="network_8c_source.html#l00051">51</a> of file <a class="el" href="network_8c_source.html">network.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   52</span>{</div>
<div class="line"><span class="lineno">   53</span>    <span class="keywordtype">size_t</span> i;</div>
<div class="line"><span class="lineno">   54</span>    <span class="keywordflow">for</span> (i = 0; i &lt; network-&gt;<a class="code hl_variable" href="structnetwork__t.html#ad5fc71e5df50072d2c5a9ebfb28c7636">layer_count</a> - 1; i++)</div>
<div class="line"><span class="lineno">   55</span>    {</div>
<div class="line"><span class="lineno">   56</span>        <a class="code hl_struct" href="structlayer__t.html">layer_t</a> *layer = network-&gt;<a class="code hl_variable" href="structnetwork__t.html#abc9801a33bc441d67a87fac3b603ae87">layers</a>[i];</div>
<div class="line"><span class="lineno">   57</span>        values[i + 1] = <a class="code hl_function" href="network_8c.html#a4ddc3e0dbc1979105df3cb54aea54319">compute_layer</a>(values[i], layer, <a class="code hl_function" href="function_8c.html#a312ab1be52b156fb23e9345424c0f2b9">activation</a>);</div>
<div class="line"><span class="lineno">   58</span>    }</div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span>    <a class="code hl_struct" href="structlayer__t.html">layer_t</a> *layer = network-&gt;<a class="code hl_variable" href="structnetwork__t.html#abc9801a33bc441d67a87fac3b603ae87">layers</a>[i];</div>
<div class="line"><span class="lineno">   61</span>    values[i + 1] = <a class="code hl_function" href="network_8c.html#a4ddc3e0dbc1979105df3cb54aea54319">compute_layer</a>(values[i], layer, <a class="code hl_function" href="function_8c.html#a4d12a97f68909050581df67de609d271">output_activation</a>);</div>
<div class="line"><span class="lineno">   62</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad534d5135c47b2ae4f4637ddcde85205" name="ad534d5135c47b2ae4f4637ddcde85205"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad534d5135c47b2ae4f4637ddcde85205">&#9670;&nbsp;</a></span>layer_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structlayer__t.html">layer_t</a> * layer_create </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structneuron__t.html">neuron_t</a> **&#160;</td>
          <td class="paramname"><em>neurons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a layer from an array of neurons. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">neurons</td><td>The array of neurons in the layer. </td></tr>
    <tr><td class="paramname">count</td><td>The count of neurons in the layer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The created layer. </dd></dl>

<p class="definition">Definition at line <a class="el" href="network_8c_source.html#l00097">97</a> of file <a class="el" href="network_8c_source.html">network.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   98</span>{</div>
<div class="line"><span class="lineno">   99</span>    <a class="code hl_struct" href="structlayer__t.html">layer_t</a> *layer = (<a class="code hl_struct" href="structlayer__t.html">layer_t</a> *)malloc(<span class="keyword">sizeof</span>(<a class="code hl_struct" href="structlayer__t.html">layer_t</a>));</div>
<div class="line"><span class="lineno">  100</span>    <span class="keywordflow">if</span> (layer == NULL)</div>
<div class="line"><span class="lineno">  101</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  102</span>    layer-&gt;<a class="code hl_variable" href="structlayer__t.html#a71e4f1a74c73f54b7ff2c40dc88c795e">neurons</a> = neurons;</div>
<div class="line"><span class="lineno">  103</span>    layer-&gt;<a class="code hl_variable" href="structlayer__t.html#a79cee7069a84d7440d56779ba2c073fb">count</a> = count;</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>    <span class="keywordflow">return</span> layer;</div>
<div class="line"><span class="lineno">  106</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="adb61905641c2a84fe9cd88fb04672361" name="adb61905641c2a84fe9cd88fb04672361"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb61905641c2a84fe9cd88fb04672361">&#9670;&nbsp;</a></span>layer_create_from_mat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structlayer__t.html">layer_t</a> * layer_create_from_mat </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmatrix__t.html">matrix_t</a> **&#160;</td>
          <td class="paramname"><em>weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>biases</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates filled layer from an array of weights, and an array of biases. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">weights</td><td>The array of weights for each neuron in the layer. </td></tr>
    <tr><td class="paramname">biases</td><td>The array of biases for each neuron in the layer. </td></tr>
    <tr><td class="paramname">count</td><td>The number of elements to be created, hence the size of weights and biases. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The created layer. </dd></dl>

<p class="definition">Definition at line <a class="el" href="network_8c_source.html#l00081">81</a> of file <a class="el" href="network_8c_source.html">network.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   83</span>{</div>
<div class="line"><span class="lineno">   84</span>    <a class="code hl_struct" href="structlayer__t.html">layer_t</a> *layer = (<a class="code hl_struct" href="structlayer__t.html">layer_t</a> *)malloc(<span class="keyword">sizeof</span>(<a class="code hl_struct" href="structlayer__t.html">layer_t</a>));</div>
<div class="line"><span class="lineno">   85</span>    <span class="keywordflow">if</span> (layer == NULL)</div>
<div class="line"><span class="lineno">   86</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">   87</span>    layer-&gt;<a class="code hl_variable" href="structlayer__t.html#a79cee7069a84d7440d56779ba2c073fb">count</a> = count;</div>
<div class="line"><span class="lineno">   88</span>    layer-&gt;<a class="code hl_variable" href="structlayer__t.html#a71e4f1a74c73f54b7ff2c40dc88c795e">neurons</a> = (<a class="code hl_struct" href="structneuron__t.html">neuron_t</a> **)malloc(count * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structneuron__t.html">neuron_t</a> *));</div>
<div class="line"><span class="lineno">   89</span>    <span class="keywordflow">if</span> (layer-&gt;<a class="code hl_variable" href="structlayer__t.html#a71e4f1a74c73f54b7ff2c40dc88c795e">neurons</a> == NULL)</div>
<div class="line"><span class="lineno">   90</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">   91</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; count; i++)</div>
<div class="line"><span class="lineno">   92</span>        layer-&gt;<a class="code hl_variable" href="structlayer__t.html#a71e4f1a74c73f54b7ff2c40dc88c795e">neurons</a>[i] = <a class="code hl_function" href="network_8c.html#aa706a2634d39e1b59182ab9a9403931c">neuron_create</a>(weights[i], biases[i]);</div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>    <span class="keywordflow">return</span> layer;</div>
<div class="line"><span class="lineno">   95</span>}</div>
<div class="ttc" id="anetwork_8c_html_aa706a2634d39e1b59182ab9a9403931c"><div class="ttname"><a href="network_8c.html#aa706a2634d39e1b59182ab9a9403931c">neuron_create</a></div><div class="ttdeci">neuron_t * neuron_create(matrix_t *weights, double bias)</div><div class="ttdoc">Creates a neuron.</div><div class="ttdef"><b>Definition:</b> <a href="network_8c_source.html#l00064">network.c:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac0e36ece7ab68f5333223ea9167938d9" name="ac0e36ece7ab68f5333223ea9167938d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0e36ece7ab68f5333223ea9167938d9">&#9670;&nbsp;</a></span>layer_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void layer_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structlayer__t.html">layer_t</a> *&#160;</td>
          <td class="paramname"><em>layer</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees an allocated layer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layer</td><td>The layer to be freed. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="network_8c_source.html#l00108">108</a> of file <a class="el" href="network_8c_source.html">network.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  109</span>{</div>
<div class="line"><span class="lineno">  110</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; layer-&gt;<a class="code hl_variable" href="structlayer__t.html#a79cee7069a84d7440d56779ba2c073fb">count</a>; i++)</div>
<div class="line"><span class="lineno">  111</span>    {</div>
<div class="line"><span class="lineno">  112</span>        <a class="code hl_function" href="network_8c.html#a634adde351458c2e8f8825c1816eeb43">neuron_free</a>(layer-&gt;<a class="code hl_variable" href="structlayer__t.html#a71e4f1a74c73f54b7ff2c40dc88c795e">neurons</a>[i]);</div>
<div class="line"><span class="lineno">  113</span>    }</div>
<div class="line"><span class="lineno">  114</span> </div>
<div class="line"><span class="lineno">  115</span>    free(layer-&gt;<a class="code hl_variable" href="structlayer__t.html#a71e4f1a74c73f54b7ff2c40dc88c795e">neurons</a>);</div>
<div class="line"><span class="lineno">  116</span>    free(layer);</div>
<div class="line"><span class="lineno">  117</span>}</div>
<div class="ttc" id="anetwork_8c_html_a634adde351458c2e8f8825c1816eeb43"><div class="ttname"><a href="network_8c.html#a634adde351458c2e8f8825c1816eeb43">neuron_free</a></div><div class="ttdeci">void neuron_free(neuron_t *neuron)</div><div class="ttdoc">Frees the allocated neuron.</div><div class="ttdef"><b>Definition:</b> <a href="network_8c_source.html#l00075">network.c:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abef62369a77da828529fbf193f111ef7" name="abef62369a77da828529fbf193f111ef7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abef62369a77da828529fbf193f111ef7">&#9670;&nbsp;</a></span>network_copy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structnetwork__t.html">network_t</a> * network_copy </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structnetwork__t.html">network_t</a> *&#160;</td>
          <td class="paramname"><em>old</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a deep copied network. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">old</td><td>The network to copy. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The copied network. </dd></dl>

<p class="definition">Definition at line <a class="el" href="network_8c_source.html#l00515">515</a> of file <a class="el" href="network_8c_source.html">network.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  516</span>{</div>
<div class="line"><span class="lineno">  517</span>    <a class="code hl_struct" href="structlayer__t.html">layer_t</a> **layers</div>
<div class="line"><span class="lineno">  518</span>        = (<a class="code hl_struct" href="structlayer__t.html">layer_t</a> **)malloc(old-&gt;<a class="code hl_variable" href="structnetwork__t.html#ad5fc71e5df50072d2c5a9ebfb28c7636">layer_count</a> * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structlayer__t.html">layer_t</a> *));</div>
<div class="line"><span class="lineno">  519</span>    <a class="code hl_struct" href="structnetwork__t.html">network_t</a> *res = <a class="code hl_function" href="network_8c.html#ad7ec187320facb456542975fd39de56e">network_create</a>(layers, old-&gt;<a class="code hl_variable" href="structnetwork__t.html#ad5fc71e5df50072d2c5a9ebfb28c7636">layer_count</a>, old-&gt;<a class="code hl_variable" href="structnetwork__t.html#af7a2fbc049a0fd2d5ad14f218658ca83">inputs</a>);</div>
<div class="line"><span class="lineno">  520</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; old-&gt;<a class="code hl_variable" href="structnetwork__t.html#ad5fc71e5df50072d2c5a9ebfb28c7636">layer_count</a>; i++)</div>
<div class="line"><span class="lineno">  521</span>    {</div>
<div class="line"><span class="lineno">  522</span>        layers[i] = layer_copy(old-&gt;<a class="code hl_variable" href="structnetwork__t.html#abc9801a33bc441d67a87fac3b603ae87">layers</a>[i]);</div>
<div class="line"><span class="lineno">  523</span>    }</div>
<div class="line"><span class="lineno">  524</span> </div>
<div class="line"><span class="lineno">  525</span>    <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno">  526</span>}</div>
<div class="ttc" id="anetwork_8c_html_ad7ec187320facb456542975fd39de56e"><div class="ttname"><a href="network_8c.html#ad7ec187320facb456542975fd39de56e">network_create</a></div><div class="ttdeci">network_t * network_create(layer_t **layers, size_t layer_count, size_t inputs)</div><div class="ttdoc">Creates a network from an array of layers.</div><div class="ttdef"><b>Definition:</b> <a href="network_8c_source.html#l00119">network.c:119</a></div></div>
<div class="ttc" id="astructnetwork__t_html"><div class="ttname"><a href="structnetwork__t.html">network_t</a></div><div class="ttdoc">A struct representing a neural network.</div><div class="ttdef"><b>Definition:</b> <a href="network_8h_source.html#l00079">network.h:80</a></div></div>
<div class="ttc" id="astructnetwork__t_html_af7a2fbc049a0fd2d5ad14f218658ca83"><div class="ttname"><a href="structnetwork__t.html#af7a2fbc049a0fd2d5ad14f218658ca83">network_t::inputs</a></div><div class="ttdeci">size_t inputs</div><div class="ttdef"><b>Definition:</b> <a href="network_8h_source.html#l00083">network.h:83</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad7ec187320facb456542975fd39de56e" name="ad7ec187320facb456542975fd39de56e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7ec187320facb456542975fd39de56e">&#9670;&nbsp;</a></span>network_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structnetwork__t.html">network_t</a> * network_create </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structlayer__t.html">layer_t</a> **&#160;</td>
          <td class="paramname"><em>layers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>inputs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a network from an array of layers. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">layers</td><td>The array of layers in the network. </td></tr>
    <tr><td class="paramname">size</td><td>The number of layers in the array. </td></tr>
    <tr><td class="paramname">inputs</td><td>The number of neurons in the input layer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The created network. </dd></dl>

<p class="definition">Definition at line <a class="el" href="network_8c_source.html#l00119">119</a> of file <a class="el" href="network_8c_source.html">network.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  120</span>{</div>
<div class="line"><span class="lineno">  121</span>    <a class="code hl_struct" href="structnetwork__t.html">network_t</a> *res = (<a class="code hl_struct" href="structnetwork__t.html">network_t</a> *)malloc(<span class="keyword">sizeof</span>(<a class="code hl_struct" href="structnetwork__t.html">network_t</a>));</div>
<div class="line"><span class="lineno">  122</span>    <span class="keywordflow">if</span> (res == NULL)</div>
<div class="line"><span class="lineno">  123</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  124</span>    res-&gt;<a class="code hl_variable" href="structnetwork__t.html#abc9801a33bc441d67a87fac3b603ae87">layers</a> = layers;</div>
<div class="line"><span class="lineno">  125</span>    res-&gt;<a class="code hl_variable" href="structnetwork__t.html#af7a2fbc049a0fd2d5ad14f218658ca83">inputs</a> = inputs;</div>
<div class="line"><span class="lineno">  126</span>    res-&gt;<a class="code hl_variable" href="structnetwork__t.html#ad5fc71e5df50072d2c5a9ebfb28c7636">layer_count</a> = layer_count;</div>
<div class="line"><span class="lineno">  127</span>    <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno">  128</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab7de60cd0ad5a69e135b63d264018d1a" name="ab7de60cd0ad5a69e135b63d264018d1a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7de60cd0ad5a69e135b63d264018d1a">&#9670;&nbsp;</a></span>network_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void network_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structnetwork__t.html">network_t</a> *&#160;</td>
          <td class="paramname"><em>network</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees the allocated network. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">network</td><td>The network to be freed. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="network_8c_source.html#l00130">130</a> of file <a class="el" href="network_8c_source.html">network.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  131</span>{</div>
<div class="line"><span class="lineno">  132</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; net-&gt;layer_count; i++)</div>
<div class="line"><span class="lineno">  133</span>    {</div>
<div class="line"><span class="lineno">  134</span>        <a class="code hl_function" href="network_8c.html#ac0e36ece7ab68f5333223ea9167938d9">layer_free</a>(net-&gt;layers[i]);</div>
<div class="line"><span class="lineno">  135</span>    }</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>    free(net-&gt;layers);</div>
<div class="line"><span class="lineno">  138</span>    free(net);</div>
<div class="line"><span class="lineno">  139</span>}</div>
<div class="ttc" id="anetwork_8c_html_ac0e36ece7ab68f5333223ea9167938d9"><div class="ttname"><a href="network_8c.html#ac0e36ece7ab68f5333223ea9167938d9">layer_free</a></div><div class="ttdeci">void layer_free(layer_t *layer)</div><div class="ttdoc">Frees an allocated layer.</div><div class="ttdef"><b>Definition:</b> <a href="network_8c_source.html#l00108">network.c:108</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aba00189ea608835915fdd9f753c33fd4" name="aba00189ea608835915fdd9f753c33fd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba00189ea608835915fdd9f753c33fd4">&#9670;&nbsp;</a></span>network_generate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structnetwork__t.html">network_t</a> * network_generate </td>
          <td>(</td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>neurons</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a network based on given neuron count. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">neurons</td><td>An array containing the number of neurons at each layer including input layer.</td></tr>
    <tr><td class="paramname">size</td><td>The length of the array, hence the number of layers plus the input layer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The generated network. </dd></dl>

<p class="definition">Definition at line <a class="el" href="network_8c_source.html#l00472">472</a> of file <a class="el" href="network_8c_source.html">network.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  473</span>{</div>
<div class="line"><span class="lineno">  474</span>    <span class="keywordflow">if</span> (size &lt; 2)</div>
<div class="line"><span class="lineno">  475</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  476</span>    <a class="code hl_struct" href="structlayer__t.html">layer_t</a> **layers = (<a class="code hl_struct" href="structlayer__t.html">layer_t</a> **)malloc((size - 1) * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structlayer__t.html">layer_t</a> *));</div>
<div class="line"><span class="lineno">  477</span>    <span class="keywordtype">size_t</span> weights = neuron_count[0];</div>
<div class="line"><span class="lineno">  478</span>    <a class="code hl_struct" href="structnetwork__t.html">network_t</a> *res = <a class="code hl_function" href="network_8c.html#ad7ec187320facb456542975fd39de56e">network_create</a>(layers, size - 1, weights);</div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 1; i &lt; size; i++)</div>
<div class="line"><span class="lineno">  481</span>    {</div>
<div class="line"><span class="lineno">  482</span>        <span class="keywordtype">size_t</span> n_count = neuron_count[i];</div>
<div class="line"><span class="lineno">  483</span>        <a class="code hl_struct" href="structneuron__t.html">neuron_t</a> **neurons = (<a class="code hl_struct" href="structneuron__t.html">neuron_t</a> **)malloc(n_count * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structneuron__t.html">neuron_t</a> *));</div>
<div class="line"><span class="lineno">  484</span>        <a class="code hl_struct" href="structlayer__t.html">layer_t</a> *layer = <a class="code hl_function" href="network_8c.html#ad534d5135c47b2ae4f4637ddcde85205">layer_create</a>(neurons, n_count);</div>
<div class="line"><span class="lineno">  485</span>        layers[i - 1] = layer;</div>
<div class="line"><span class="lineno">  486</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ni = 0; ni &lt; n_count; ni++)</div>
<div class="line"><span class="lineno">  487</span>        {</div>
<div class="line"><span class="lineno">  488</span>            <span class="keywordtype">double</span> *values = <a class="code hl_function" href="function_8c.html#ae6d5ccd297429cb956c9a4deb3d5daa8">generate_weights</a>(weights + 1);</div>
<div class="line"><span class="lineno">  489</span>            layers[i - 1]-&gt;<a class="code hl_variable" href="structlayer__t.html#a71e4f1a74c73f54b7ff2c40dc88c795e">neurons</a>[ni] = parse_results(values, weights);</div>
<div class="line"><span class="lineno">  490</span>            free(values);</div>
<div class="line"><span class="lineno">  491</span>        }</div>
<div class="line"><span class="lineno">  492</span>        weights = n_count;</div>
<div class="line"><span class="lineno">  493</span>    }</div>
<div class="line"><span class="lineno">  494</span> </div>
<div class="line"><span class="lineno">  495</span>    <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno">  496</span>}</div>
<div class="ttc" id="afunction_8c_html_ae6d5ccd297429cb956c9a4deb3d5daa8"><div class="ttname"><a href="function_8c.html#ae6d5ccd297429cb956c9a4deb3d5daa8">generate_weights</a></div><div class="ttdeci">double * generate_weights(double n)</div><div class="ttdoc">Returns a double pointer with values following normal distribution; of element for the distribution.</div><div class="ttdef"><b>Definition:</b> <a href="function_8c_source.html#l00072">function.c:72</a></div></div>
<div class="ttc" id="anetwork_8c_html_ad534d5135c47b2ae4f4637ddcde85205"><div class="ttname"><a href="network_8c.html#ad534d5135c47b2ae4f4637ddcde85205">layer_create</a></div><div class="ttdeci">layer_t * layer_create(neuron_t **neurons, size_t count)</div><div class="ttdoc">Creates a layer from an array of neurons.</div><div class="ttdef"><b>Definition:</b> <a href="network_8c_source.html#l00097">network.c:97</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a338eaca7b062c45c2ddf651ec7bfb5ab" name="a338eaca7b062c45c2ddf651ec7bfb5ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a338eaca7b062c45c2ddf651ec7bfb5ab">&#9670;&nbsp;</a></span>network_get_output()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int network_get_output </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmatrix__t.html">matrix_t</a> *&#160;</td>
          <td class="paramname"><em>outputs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>threshold</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return the calculated output. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">outputs</td><td>The matrix of outputs given by the network. </td></tr>
    <tr><td class="paramname">threshold</td><td>The threshold starting from which the result will be considered as valid. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The calculated output or -1 if none above the threshold. </dd></dl>

<p class="definition">Definition at line <a class="el" href="network_8c_source.html#l00634">634</a> of file <a class="el" href="network_8c_source.html">network.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  635</span>{</div>
<div class="line"><span class="lineno">  636</span>    <span class="keywordtype">int</span> result = -1;</div>
<div class="line"><span class="lineno">  637</span>    <span class="keywordtype">double</span> old_value = 0;</div>
<div class="line"><span class="lineno">  638</span>    <span class="keywordflow">for</span>(<span class="keywordtype">size_t</span> i = 0; i &lt; outputs-&gt;<a class="code hl_variable" href="structmatrix__t.html#a9620f15b4416ec1830196db9ec904fc5">rows</a>; i++) {</div>
<div class="line"><span class="lineno">  639</span>        <span class="keywordtype">double</span> val = <a class="code hl_function" href="matrix_8c.html#a631ff21351ba5ec31350fb5277605d3b">mat_el_at</a>(outputs, i, 0);</div>
<div class="line"><span class="lineno">  640</span>        <span class="keywordflow">if</span>(val &lt; threshold)</div>
<div class="line"><span class="lineno">  641</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  642</span>        <span class="keywordflow">if</span>(val &gt; old_value) {</div>
<div class="line"><span class="lineno">  643</span>            result = i;</div>
<div class="line"><span class="lineno">  644</span>            old_value = val;</div>
<div class="line"><span class="lineno">  645</span>        }</div>
<div class="line"><span class="lineno">  646</span>    }</div>
<div class="line"><span class="lineno">  647</span> </div>
<div class="line"><span class="lineno">  648</span>    <span class="keywordflow">return</span> result;</div>
<div class="line"><span class="lineno">  649</span>}</div>
<div class="ttc" id="astructmatrix__t_html_a9620f15b4416ec1830196db9ec904fc5"><div class="ttname"><a href="structmatrix__t.html#a9620f15b4416ec1830196db9ec904fc5">matrix_t::rows</a></div><div class="ttdeci">size_t rows</div><div class="ttdef"><b>Definition:</b> <a href="matrix_8h_source.html#l00012">matrix.h:12</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a71f0aa4f7efea3ff158a49342228bb80" name="a71f0aa4f7efea3ff158a49342228bb80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71f0aa4f7efea3ff158a49342228bb80">&#9670;&nbsp;</a></span>network_load()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structnetwork__t.html">network_t</a> * network_load </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Loads the network from a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>The path of the file to load. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The loaded network. The file format: The file will start with two comma-separated integer indicating the number of layers and the number of input neurons. Each layer will start by the number of neurons in the layer. Then each neuron information will be seperated by a newline char. Neuron format: &lt;weight1&gt;, ... , &lt;weightn&gt;, &lt;bias&gt; Example for xor network with random biases and weights: 2,2 # The number of layers and the number of input neurons. 2 # The number of neurons in layer 1 1,1,-0.5 # neuron 1,1 weights are [1, 1] and the bias is -0.5 -1,-1,1.5 1 # The number of neurons in layer 2 1, 1, 0.5 </dd></dl>

<p class="definition">Definition at line <a class="el" href="network_8c_source.html#l00381">381</a> of file <a class="el" href="network_8c_source.html">network.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  382</span>{</div>
<div class="line"><span class="lineno">  383</span>    <span class="comment">// open the file</span></div>
<div class="line"><span class="lineno">  384</span>    FILE *file = fopen(path, <span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><span class="lineno">  385</span>    <a class="code hl_define" href="network_8c.html#a28a631a46550a13bbf48635953aafcbd">CHK</a>(file, <span class="stringliteral">&quot;network_load&quot;</span>, <span class="stringliteral">&quot;could not open file&quot;</span>);</div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span>    <span class="keywordtype">size_t</span> layer_count, weight_count, neuron_count = 0;</div>
<div class="line"><span class="lineno">  388</span>    <span class="keywordtype">size_t</span> neuron_index = 0, layer_index = 0;</div>
<div class="line"><span class="lineno">  389</span>    <span class="keywordtype">int</span> in_layer = 0;</div>
<div class="line"><span class="lineno">  390</span>    <span class="keywordtype">size_t</span> line = 0;</div>
<div class="line"><span class="lineno">  391</span>    <span class="keywordtype">int</span> alive = parse_header(file, &amp;layer_count, &amp;neuron_count, &amp;line);</div>
<div class="line"><span class="lineno">  392</span>    line++;</div>
<div class="line"><span class="lineno">  393</span>    <span class="keywordflow">if</span> (!alive)</div>
<div class="line"><span class="lineno">  394</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  395</span> </div>
<div class="line"><span class="lineno">  396</span>    <a class="code hl_struct" href="structlayer__t.html">layer_t</a> **layers = (<a class="code hl_struct" href="structlayer__t.html">layer_t</a> **)malloc(layer_count * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structlayer__t.html">layer_t</a> *));</div>
<div class="line"><span class="lineno">  397</span>    <a class="code hl_struct" href="structnetwork__t.html">network_t</a> *res = <a class="code hl_function" href="network_8c.html#ad7ec187320facb456542975fd39de56e">network_create</a>(layers, layer_count, neuron_count);</div>
<div class="line"><span class="lineno">  398</span>    <span class="keywordtype">double</span> *values;</div>
<div class="line"><span class="lineno">  399</span>    <span class="keywordflow">while</span> (layer_index &lt; layer_count)</div>
<div class="line"><span class="lineno">  400</span>    {</div>
<div class="line"><span class="lineno">  401</span>        <span class="keywordflow">if</span> (!in_layer)</div>
<div class="line"><span class="lineno">  402</span>        {</div>
<div class="line"><span class="lineno">  403</span>            weight_count = neuron_count;</div>
<div class="line"><span class="lineno">  404</span>            alive = parse_layer_header(file, &amp;neuron_count, &amp;line);</div>
<div class="line"><span class="lineno">  405</span>            line++;</div>
<div class="line"><span class="lineno">  406</span>            neuron_index = 0;</div>
<div class="line"><span class="lineno">  407</span>            in_layer = 1;</div>
<div class="line"><span class="lineno">  408</span>            layers[layer_index] = <a class="code hl_function" href="network_8c.html#ad534d5135c47b2ae4f4637ddcde85205">layer_create</a>(</div>
<div class="line"><span class="lineno">  409</span>                (<a class="code hl_struct" href="structneuron__t.html">neuron_t</a> **)malloc(neuron_count * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structneuron__t.html">neuron_t</a> *)),</div>
<div class="line"><span class="lineno">  410</span>                neuron_count);</div>
<div class="line"><span class="lineno">  411</span>        }</div>
<div class="line"><span class="lineno">  412</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  413</span>        {</div>
<div class="line"><span class="lineno">  414</span>            <span class="keywordflow">if</span> (neuron_count == neuron_index)</div>
<div class="line"><span class="lineno">  415</span>            {</div>
<div class="line"><span class="lineno">  416</span>                in_layer = 0;</div>
<div class="line"><span class="lineno">  417</span>                layer_index++;</div>
<div class="line"><span class="lineno">  418</span>            }</div>
<div class="line"><span class="lineno">  419</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  420</span>            {</div>
<div class="line"><span class="lineno">  421</span>                values = (<span class="keywordtype">double</span> *)malloc((weight_count + 1) * <span class="keyword">sizeof</span>(double));</div>
<div class="line"><span class="lineno">  422</span>                alive</div>
<div class="line"><span class="lineno">  423</span>                    = parse_neuron_line(file, values, weight_count + 1, &amp;line);</div>
<div class="line"><span class="lineno">  424</span>                line++;</div>
<div class="line"><span class="lineno">  425</span>                layers[layer_index]-&gt;<a class="code hl_variable" href="structlayer__t.html#a71e4f1a74c73f54b7ff2c40dc88c795e">neurons</a>[neuron_index]</div>
<div class="line"><span class="lineno">  426</span>                    = parse_results(values, weight_count);</div>
<div class="line"><span class="lineno">  427</span>                free(values);</div>
<div class="line"><span class="lineno">  428</span>                neuron_index++;</div>
<div class="line"><span class="lineno">  429</span>            }</div>
<div class="line"><span class="lineno">  430</span>        }</div>
<div class="line"><span class="lineno">  431</span>    }</div>
<div class="line"><span class="lineno">  432</span>    <span class="comment">// close the file</span></div>
<div class="line"><span class="lineno">  433</span>    fclose(file);</div>
<div class="line"><span class="lineno">  434</span>    <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno">  435</span>}</div>
<div class="ttc" id="anetwork_8c_html_a28a631a46550a13bbf48635953aafcbd"><div class="ttname"><a href="network_8c.html#a28a631a46550a13bbf48635953aafcbd">CHK</a></div><div class="ttdeci">#define CHK(ptr, function, message)</div><div class="ttdoc">checks if a pointer is null.</div><div class="ttdef"><b>Definition:</b> <a href="network_8c_source.html#l00008">network.c:8</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aee995127aad46272ae3ddc5dfef07edc" name="aee995127aad46272ae3ddc5dfef07edc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee995127aad46272ae3ddc5dfef07edc">&#9670;&nbsp;</a></span>network_save()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void network_save </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structnetwork__t.html">network_t</a> *&#160;</td>
          <td class="paramname"><em>network</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Saves a network to a file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">file</td><td>The file to save the network to. </td></tr>
    <tr><td class="paramname">network</td><td>The network to be saved. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="network_8c_source.html#l00457">457</a> of file <a class="el" href="network_8c_source.html">network.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  458</span>{</div>
<div class="line"><span class="lineno">  459</span>    FILE *file = fopen(path, <span class="stringliteral">&quot;w&quot;</span>);</div>
<div class="line"><span class="lineno">  460</span>    <a class="code hl_define" href="network_8c.html#a28a631a46550a13bbf48635953aafcbd">CHK</a>(file, <span class="stringliteral">&quot;network_save&quot;</span>, <span class="stringliteral">&quot;could not open file&quot;</span>);</div>
<div class="line"><span class="lineno">  461</span>    fprintf(file, <span class="stringliteral">&quot;%zu, %zu\n&quot;</span>, net-&gt;layer_count, net-&gt;inputs);</div>
<div class="line"><span class="lineno">  462</span>    <span class="keywordtype">size_t</span> weight_count = net-&gt;inputs;</div>
<div class="line"><span class="lineno">  463</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; net-&gt;layer_count; i++)</div>
<div class="line"><span class="lineno">  464</span>    {</div>
<div class="line"><span class="lineno">  465</span>        fprintf(file, <span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno">  466</span>        layer_save(file, net-&gt;layers[i], weight_count);</div>
<div class="line"><span class="lineno">  467</span>        weight_count = net-&gt;layers[i]-&gt;count;</div>
<div class="line"><span class="lineno">  468</span>    }</div>
<div class="line"><span class="lineno">  469</span>    fclose(file);</div>
<div class="line"><span class="lineno">  470</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac99789abdffa9915778914a50c1b4514" name="ac99789abdffa9915778914a50c1b4514"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac99789abdffa9915778914a50c1b4514">&#9670;&nbsp;</a></span>network_train()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void network_train </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structnetwork__t.html">network_t</a> **&#160;</td>
          <td class="paramname"><em>pnet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmatrix__t.html">matrix_t</a> *&#160;</td>
          <td class="paramname"><em>inputs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmatrix__t.html">matrix_t</a> *&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="network_8c_source.html#l00594">594</a> of file <a class="el" href="network_8c_source.html">network.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  596</span>{</div>
<div class="line"><span class="lineno">  597</span>    <a class="code hl_struct" href="structnetwork__t.html">network_t</a> *trained = <a class="code hl_function" href="network_8c.html#abef62369a77da828529fbf193f111ef7">network_copy</a>(*pnet);</div>
<div class="line"><span class="lineno">  598</span> </div>
<div class="line"><span class="lineno">  599</span>    <a class="code hl_struct" href="structmatrix__t.html">matrix_t</a> **outputs</div>
<div class="line"><span class="lineno">  600</span>        = (<a class="code hl_struct" href="structmatrix__t.html">matrix_t</a> **)malloc(((*pnet)-&gt;layer_count + 1) * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structmatrix__t.html">matrix_t</a> *));</div>
<div class="line"><span class="lineno">  601</span>    outputs[0] = inputs;</div>
<div class="line"><span class="lineno">  602</span> </div>
<div class="line"><span class="lineno">  603</span>    <a class="code hl_struct" href="structmatrix__t.html">matrix_t</a> **deltas</div>
<div class="line"><span class="lineno">  604</span>        = (<a class="code hl_struct" href="structmatrix__t.html">matrix_t</a> **)malloc((*pnet)-&gt;layer_count * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structmatrix__t.html">matrix_t</a> *));</div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span>    <a class="code hl_function" href="network_8c.html#ab872ac733c73ac5b412e9da46426a3ad">compute_result_with_save</a>(outputs, *pnet);</div>
<div class="line"><span class="lineno">  607</span> </div>
<div class="line"><span class="lineno">  608</span>    <span class="keywordtype">size_t</span> layer_i = trained-&gt;<a class="code hl_variable" href="structnetwork__t.html#ad5fc71e5df50072d2c5a9ebfb28c7636">layer_count</a> - 1;</div>
<div class="line"><span class="lineno">  609</span>    <a class="code hl_struct" href="structlayer__t.html">layer_t</a> *trained_layer = trained-&gt;<a class="code hl_variable" href="structnetwork__t.html#abc9801a33bc441d67a87fac3b603ae87">layers</a>[layer_i];</div>
<div class="line"><span class="lineno">  610</span>    <a class="code hl_struct" href="structlayer__t.html">layer_t</a> *old_layer = (*pnet)-&gt;layers[layer_i];</div>
<div class="line"><span class="lineno">  611</span>    deltas[layer_i] = <a class="code hl_function" href="matrix_8c.html#a1d9b061fc8856e727f014c3266b7431d">matrix_create</a>(trained_layer-&gt;<a class="code hl_variable" href="structlayer__t.html#a79cee7069a84d7440d56779ba2c073fb">count</a>, 1, 0);</div>
<div class="line"><span class="lineno">  612</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ni = 0; ni &lt; trained_layer-&gt;<a class="code hl_variable" href="structlayer__t.html#a79cee7069a84d7440d56779ba2c073fb">count</a>; ni++)</div>
<div class="line"><span class="lineno">  613</span>    {</div>
<div class="line"><span class="lineno">  614</span>        <span class="keywordtype">double</span> delta = output_neuron_train(trained_layer-&gt;<a class="code hl_variable" href="structlayer__t.html#a71e4f1a74c73f54b7ff2c40dc88c795e">neurons</a>[ni],</div>
<div class="line"><span class="lineno">  615</span>            old_layer-&gt;<a class="code hl_variable" href="structlayer__t.html#a71e4f1a74c73f54b7ff2c40dc88c795e">neurons</a>[ni], rate, <a class="code hl_function" href="matrix_8c.html#a631ff21351ba5ec31350fb5277605d3b">mat_el_at</a>(target, ni, 0),</div>
<div class="line"><span class="lineno">  616</span>            <a class="code hl_function" href="matrix_8c.html#a631ff21351ba5ec31350fb5277605d3b">mat_el_at</a>(outputs[layer_i + 1], ni, 0), outputs[layer_i]);</div>
<div class="line"><span class="lineno">  617</span>        <a class="code hl_function" href="matrix_8c.html#a0e411263cdaaa67eae166d067996f5b6">mat_set_el</a>(deltas[layer_i], ni, 0, delta);</div>
<div class="line"><span class="lineno">  618</span>    }</div>
<div class="line"><span class="lineno">  619</span> </div>
<div class="line"><span class="lineno">  620</span>    compute_deltas(outputs, *pnet, deltas);</div>
<div class="line"><span class="lineno">  621</span>    hidden_layer_train(outputs, trained, deltas, rate);</div>
<div class="line"><span class="lineno">  622</span> </div>
<div class="line"><span class="lineno">  623</span>    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 1; i &lt;= trained-&gt;<a class="code hl_variable" href="structnetwork__t.html#ad5fc71e5df50072d2c5a9ebfb28c7636">layer_count</a>; i++)</div>
<div class="line"><span class="lineno">  624</span>    {</div>
<div class="line"><span class="lineno">  625</span>        <a class="code hl_function" href="matrix_8c.html#aa20fd2a5c773eda620ce98e2f121b687">matrix_free</a>(outputs[i]);</div>
<div class="line"><span class="lineno">  626</span>        <a class="code hl_function" href="matrix_8c.html#aa20fd2a5c773eda620ce98e2f121b687">matrix_free</a>(deltas[i - 1]);</div>
<div class="line"><span class="lineno">  627</span>    }</div>
<div class="line"><span class="lineno">  628</span>    free(outputs);</div>
<div class="line"><span class="lineno">  629</span>    free(deltas);</div>
<div class="line"><span class="lineno">  630</span>    <a class="code hl_function" href="network_8c.html#ab7de60cd0ad5a69e135b63d264018d1a">network_free</a>(*pnet);</div>
<div class="line"><span class="lineno">  631</span>    *pnet = trained;</div>
<div class="line"><span class="lineno">  632</span>}</div>
<div class="ttc" id="anetwork_8c_html_ab7de60cd0ad5a69e135b63d264018d1a"><div class="ttname"><a href="network_8c.html#ab7de60cd0ad5a69e135b63d264018d1a">network_free</a></div><div class="ttdeci">void network_free(network_t *net)</div><div class="ttdoc">Frees the allocated network.</div><div class="ttdef"><b>Definition:</b> <a href="network_8c_source.html#l00130">network.c:130</a></div></div>
<div class="ttc" id="anetwork_8c_html_ab872ac733c73ac5b412e9da46426a3ad"><div class="ttname"><a href="network_8c.html#ab872ac733c73ac5b412e9da46426a3ad">compute_result_with_save</a></div><div class="ttdeci">void compute_result_with_save(matrix_t **values, network_t *network)</div><div class="ttdef"><b>Definition:</b> <a href="network_8c_source.html#l00051">network.c:51</a></div></div>
<div class="ttc" id="anetwork_8c_html_abef62369a77da828529fbf193f111ef7"><div class="ttname"><a href="network_8c.html#abef62369a77da828529fbf193f111ef7">network_copy</a></div><div class="ttdeci">network_t * network_copy(network_t *old)</div><div class="ttdoc">Create a deep copied network.</div><div class="ttdef"><b>Definition:</b> <a href="network_8c_source.html#l00515">network.c:515</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa706a2634d39e1b59182ab9a9403931c" name="aa706a2634d39e1b59182ab9a9403931c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa706a2634d39e1b59182ab9a9403931c">&#9670;&nbsp;</a></span>neuron_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structneuron__t.html">neuron_t</a> * neuron_create </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmatrix__t.html">matrix_t</a> *&#160;</td>
          <td class="paramname"><em>weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>bias</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a neuron. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">weights</td><td>The weights of the neuron. </td></tr>
    <tr><td class="paramname">bias</td><td>The bias of the neuron. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The instantiated neuron. </dd></dl>

<p class="definition">Definition at line <a class="el" href="network_8c_source.html#l00064">64</a> of file <a class="el" href="network_8c_source.html">network.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   65</span>{</div>
<div class="line"><span class="lineno">   66</span>    <a class="code hl_struct" href="structneuron__t.html">neuron_t</a> *neuron = (<a class="code hl_struct" href="structneuron__t.html">neuron_t</a> *)malloc(<span class="keyword">sizeof</span>(<a class="code hl_struct" href="structneuron__t.html">neuron_t</a>));</div>
<div class="line"><span class="lineno">   67</span>    <span class="keywordflow">if</span> (neuron == NULL)</div>
<div class="line"><span class="lineno">   68</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">   69</span>    neuron-&gt;<a class="code hl_variable" href="structneuron__t.html#a6182effa3a478564d7dcd7f9d856c029">weights</a> = weights;</div>
<div class="line"><span class="lineno">   70</span>    neuron-&gt;<a class="code hl_variable" href="structneuron__t.html#ad82dab1b1a60940e62e80270ad99a522">bias</a> = bias;</div>
<div class="line"><span class="lineno">   71</span> </div>
<div class="line"><span class="lineno">   72</span>    <span class="keywordflow">return</span> neuron;</div>
<div class="line"><span class="lineno">   73</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a634adde351458c2e8f8825c1816eeb43" name="a634adde351458c2e8f8825c1816eeb43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a634adde351458c2e8f8825c1816eeb43">&#9670;&nbsp;</a></span>neuron_free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void neuron_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structneuron__t.html">neuron_t</a> *&#160;</td>
          <td class="paramname"><em>neuron</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees the allocated neuron. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">neuron</td><td>The neuron to free. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="network_8c_source.html#l00075">75</a> of file <a class="el" href="network_8c_source.html">network.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   76</span>{</div>
<div class="line"><span class="lineno">   77</span>    <a class="code hl_function" href="matrix_8c.html#aa20fd2a5c773eda620ce98e2f121b687">matrix_free</a>(neuron-&gt;<a class="code hl_variable" href="structneuron__t.html#a6182effa3a478564d7dcd7f9d856c029">weights</a>);</div>
<div class="line"><span class="lineno">   78</span>    free(neuron);</div>
<div class="line"><span class="lineno">   79</span>}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
