\hypertarget{main_8c}{}\doxysection{src/main.c File Reference}
\label{main_8c}\index{src/main.c@{src/main.c}}
{\ttfamily \#include $<$err.\+h$>$}\newline
{\ttfamily \#include $<$gtk/gtk.\+h$>$}\newline
{\ttfamily \#include $<$gtk/gtkx.\+h$>$}\newline
{\ttfamily \#include $<$math.\+h$>$}\newline
{\ttfamily \#include $<$signal.\+h$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include \char`\"{}./cli/parser.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}./network/network.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}./solver/solver.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}./ui/ui.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}./utils/matrices/matrix.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}./utils/mnist/loader.\+h\char`\"{}}\newline
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{main_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(x)~(void)(x)
\item 
\#define \mbox{\hyperlink{main_8c_ab84718f3a6e359bcc6615580caacd5d0}{PRINT\+\_\+\+PARAM}}(params,  key)~    printf(\char`\"{}\%s\+: \textbackslash{}\textquotesingle{}\%d\textbackslash{}\textquotesingle{} -\/$>$ \%s\textbackslash{}n\char`\"{}, \#key, key, params\mbox{[}key\mbox{]})
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{main_8c_a3c04138a5bfe5d72780bb7e82a18e627}{main}} (int argc, char $\ast$$\ast$argv)
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{main_8c_ab84718f3a6e359bcc6615580caacd5d0}\label{main_8c_ab84718f3a6e359bcc6615580caacd5d0}} 
\index{main.c@{main.c}!PRINT\_PARAM@{PRINT\_PARAM}}
\index{PRINT\_PARAM@{PRINT\_PARAM}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{PRINT\_PARAM}{PRINT\_PARAM}}
{\footnotesize\ttfamily \#define PRINT\+\_\+\+PARAM(\begin{DoxyParamCaption}\item[{}]{params,  }\item[{}]{key }\end{DoxyParamCaption})~    printf(\char`\"{}\%s\+: \textbackslash{}\textquotesingle{}\%d\textbackslash{}\textquotesingle{} -\/$>$ \%s\textbackslash{}n\char`\"{}, \#key, key, params\mbox{[}key\mbox{]})}



Definition at line 129 of file main.\+c.

\mbox{\Hypertarget{main_8c_a86d500a34c624c2cae56bc25a31b12f3}\label{main_8c_a86d500a34c624c2cae56bc25a31b12f3}} 
\index{main.c@{main.c}!UNUSED@{UNUSED}}
\index{UNUSED@{UNUSED}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{UNUSED}{UNUSED}}
{\footnotesize\ttfamily \#define UNUSED(\begin{DoxyParamCaption}\item[{}]{x }\end{DoxyParamCaption})~(void)(x)}



Definition at line 16 of file main.\+c.



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{main_8c_a3c04138a5bfe5d72780bb7e82a18e627}\label{main_8c_a3c04138a5bfe5d72780bb7e82a18e627}} 
\index{main.c@{main.c}!main@{main}}
\index{main@{main}!main.c@{main.c}}
\doxysubsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}\item[{int}]{argc,  }\item[{char $\ast$$\ast$}]{argv }\end{DoxyParamCaption})}



Definition at line 146 of file main.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{147 \{}
\DoxyCodeLine{148     \mbox{\hyperlink{main_8c_a86d500a34c624c2cae56bc25a31b12f3}{UNUSED}}(print\_params);}
\DoxyCodeLine{149     \textcolor{keywordtype}{char} mode;}
\DoxyCodeLine{150     \mbox{\hyperlink{parser_8h_a956c158032da3a69086ec31168c991ba}{params\_t}} params = \mbox{\hyperlink{parser_8c_af33c60f53ba8a04782e03a8500c5d099}{parse\_params}}(argc, argv, \&mode);}
\DoxyCodeLine{151     \textcolor{keywordflow}{if} (params == NULL)}
\DoxyCodeLine{152     \{}
\DoxyCodeLine{153         \mbox{\hyperlink{ui_8c_acc2b0b54bf0cf819bb23bd351bebfa06}{open\_ui}}();}
\DoxyCodeLine{154         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{155     \}}
\DoxyCodeLine{156     signal(SIGINT, int\_handler);}
\DoxyCodeLine{157     \textcolor{keywordflow}{if} (mode == \mbox{\hyperlink{parser_8h_a9bfdcc2e01a085b81125cadcfe83cb66}{TRAIN\_MODE}})}
\DoxyCodeLine{158     \{}
\DoxyCodeLine{159         \mbox{\hyperlink{structnetwork__t}{network\_t}} *net = get\_train\_network(params);}
\DoxyCodeLine{160         \mbox{\hyperlink{structmatrix__t}{matrix\_t}} **inputs;}
\DoxyCodeLine{161         \mbox{\hyperlink{structmatrix__t}{matrix\_t}} **outputs;}
\DoxyCodeLine{162         \textcolor{keywordtype}{size\_t} length = load\_train\_data(params, \&inputs, \&outputs, net-\/>\mbox{\hyperlink{structnetwork__t_af7a2fbc049a0fd2d5ad14f218658ca83}{inputs}},}
\DoxyCodeLine{163             net-\/>\mbox{\hyperlink{structnetwork__t_abc9801a33bc441d67a87fac3b603ae87}{layers}}[net-\/>\mbox{\hyperlink{structnetwork__t_ad5fc71e5df50072d2c5a9ebfb28c7636}{layer\_count}} -\/ 1]-\/>\mbox{\hyperlink{structlayer__t_a79cee7069a84d7440d56779ba2c073fb}{count}});}
\DoxyCodeLine{164 }
\DoxyCodeLine{165         \textcolor{keywordtype}{size\_t} iterations = 0;}
\DoxyCodeLine{166         \textcolor{keywordflow}{if} (params[\mbox{\hyperlink{parser_8h_aa9cc087d076e4fa101f8794a947bd01a}{ITERATIONS}}] == NULL}
\DoxyCodeLine{167             || sscanf(params[\mbox{\hyperlink{parser_8h_aa9cc087d076e4fa101f8794a947bd01a}{ITERATIONS}}], \textcolor{stringliteral}{"{}\%zu"{}}, \&iterations) == 0)}
\DoxyCodeLine{168         \{}
\DoxyCodeLine{169             iterations = 0;}
\DoxyCodeLine{170         \}}
\DoxyCodeLine{171         \textcolor{keywordflow}{else}}
\DoxyCodeLine{172         \{}
\DoxyCodeLine{173             keep\_running = 0;}
\DoxyCodeLine{174         \}}
\DoxyCodeLine{175         printf(\textcolor{stringliteral}{"{}starting the training\(\backslash\)n"{}});}
\DoxyCodeLine{176 }
\DoxyCodeLine{177         \textcolor{keywordtype}{double} rate = get\_rate(params);}
\DoxyCodeLine{178         \textcolor{keywordtype}{int} running = keep\_running || iterations > 0;}
\DoxyCodeLine{179         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; running; i++)}
\DoxyCodeLine{180         \{}
\DoxyCodeLine{181             \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} j = 0; j < length \&\& (running); j++)}
\DoxyCodeLine{182             \{}
\DoxyCodeLine{183                 \mbox{\hyperlink{network_8c_ac99789abdffa9915778914a50c1b4514}{network\_train}}(\&net, inputs[j], outputs[j], rate);}
\DoxyCodeLine{184                 running = keep\_running || i < iterations;}
\DoxyCodeLine{185             \}}
\DoxyCodeLine{186             printf(\textcolor{stringliteral}{"{}iteration \%zu\(\backslash\)n"{}}, i + 1);}
\DoxyCodeLine{187         \}}
\DoxyCodeLine{188 }
\DoxyCodeLine{189         printf(\textcolor{stringliteral}{"{}saving to \%s\(\backslash\)n"{}}, params[\mbox{\hyperlink{parser_8h_a0bbb2b623b27fdae8210c686fbcfc698}{OUTPUT\_NETWORK}}]);}
\DoxyCodeLine{190         \mbox{\hyperlink{network_8c_aee995127aad46272ae3ddc5dfef07edc}{network\_save}}(params[\mbox{\hyperlink{parser_8h_a0bbb2b623b27fdae8210c686fbcfc698}{OUTPUT\_NETWORK}}], net);}
\DoxyCodeLine{191         \mbox{\hyperlink{network_8c_ab7de60cd0ad5a69e135b63d264018d1a}{network\_free}}(net);}
\DoxyCodeLine{192         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < length; i++)}
\DoxyCodeLine{193         \{}
\DoxyCodeLine{194             \mbox{\hyperlink{matrix_8c_aa20fd2a5c773eda620ce98e2f121b687}{matrix\_free}}(inputs[i]);}
\DoxyCodeLine{195             \mbox{\hyperlink{matrix_8c_aa20fd2a5c773eda620ce98e2f121b687}{matrix\_free}}(outputs[i]);}
\DoxyCodeLine{196         \}}
\DoxyCodeLine{197 }
\DoxyCodeLine{198         free(inputs);}
\DoxyCodeLine{199         free(outputs);}
\DoxyCodeLine{200         free(params);}
\DoxyCodeLine{201     \}}
\DoxyCodeLine{202     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (mode == \mbox{\hyperlink{parser_8h_ab6d58cce6e97b6b549801e696ac9f4f6}{TEST\_MODE}})}
\DoxyCodeLine{203     \{}
\DoxyCodeLine{204 }
\DoxyCodeLine{205         \mbox{\hyperlink{structnetwork__t}{network\_t}} *net = get\_train\_network(params);}
\DoxyCodeLine{206         \mbox{\hyperlink{structmatrix__t}{matrix\_t}} **inputs;}
\DoxyCodeLine{207         \mbox{\hyperlink{structmatrix__t}{matrix\_t}} **outputs;}
\DoxyCodeLine{208         \textcolor{keywordtype}{size\_t} length = load\_train\_data(params, \&inputs, \&outputs, net-\/>\mbox{\hyperlink{structnetwork__t_af7a2fbc049a0fd2d5ad14f218658ca83}{inputs}},}
\DoxyCodeLine{209             net-\/>\mbox{\hyperlink{structnetwork__t_abc9801a33bc441d67a87fac3b603ae87}{layers}}[net-\/>\mbox{\hyperlink{structnetwork__t_ad5fc71e5df50072d2c5a9ebfb28c7636}{layer\_count}} -\/ 1]-\/>\mbox{\hyperlink{structlayer__t_a79cee7069a84d7440d56779ba2c073fb}{count}});}
\DoxyCodeLine{210 }
\DoxyCodeLine{211         printf(\textcolor{stringliteral}{"{}starting the test\(\backslash\)n"{}});}
\DoxyCodeLine{212 }
\DoxyCodeLine{213         \textcolor{keywordtype}{size\_t} succeeded = 0, tests = 0;}
\DoxyCodeLine{214         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} j = 0; j < length \&\& keep\_running; j++)}
\DoxyCodeLine{215         \{}
\DoxyCodeLine{216             \mbox{\hyperlink{structmatrix__t}{matrix\_t}} *res = \mbox{\hyperlink{network_8c_a0deec64877feb7870914ededb0a09746}{compute\_results}}(inputs[j], net);}
\DoxyCodeLine{217             \textcolor{keywordtype}{int} out = \mbox{\hyperlink{network_8c_a338eaca7b062c45c2ddf651ec7bfb5ab}{network\_get\_output}}(res, 0);}
\DoxyCodeLine{218             \textcolor{keywordtype}{int} ex = \mbox{\hyperlink{network_8c_a338eaca7b062c45c2ddf651ec7bfb5ab}{network\_get\_output}}(outputs[j], 0);}
\DoxyCodeLine{219             \mbox{\hyperlink{matrix_8c_aa20fd2a5c773eda620ce98e2f121b687}{matrix\_free}}(res);}
\DoxyCodeLine{220             \textcolor{keywordflow}{if} (out == ex)}
\DoxyCodeLine{221                 succeeded++;}
\DoxyCodeLine{222             tests++;}
\DoxyCodeLine{223         \}}
\DoxyCodeLine{224         printf(\textcolor{stringliteral}{"{}rate: \%.2f\%c\(\backslash\)n"{}}, 100.0 * succeeded / (\textcolor{keywordtype}{double})tests, \textcolor{charliteral}{'\%'});}
\DoxyCodeLine{225 }
\DoxyCodeLine{226         \mbox{\hyperlink{network_8c_ab7de60cd0ad5a69e135b63d264018d1a}{network\_free}}(net);}
\DoxyCodeLine{227         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < length; i++)}
\DoxyCodeLine{228         \{}
\DoxyCodeLine{229             \mbox{\hyperlink{matrix_8c_aa20fd2a5c773eda620ce98e2f121b687}{matrix\_free}}(inputs[i]);}
\DoxyCodeLine{230             \mbox{\hyperlink{matrix_8c_aa20fd2a5c773eda620ce98e2f121b687}{matrix\_free}}(outputs[i]);}
\DoxyCodeLine{231         \}}
\DoxyCodeLine{232 }
\DoxyCodeLine{233         free(inputs);}
\DoxyCodeLine{234         free(outputs);}
\DoxyCodeLine{235         free(params);}
\DoxyCodeLine{236     \}}
\DoxyCodeLine{237 }
\DoxyCodeLine{238     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{239 \}}

\end{DoxyCode}
