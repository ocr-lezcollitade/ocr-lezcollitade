\hypertarget{loader_8h}{}\doxysection{src/utils/mnist/loader.h File Reference}
\label{loader_8h}\index{src/utils/mnist/loader.h@{src/utils/mnist/loader.h}}
{\ttfamily \#include \char`\"{}../matrices/matrix.\+h\char`\"{}}\newline
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{loader_8h_a399981b4dd18f0e6b9252badf307ce05}{BINARY\+\_\+\+MODE}}~\char`\"{}rb\char`\"{}
\item 
\#define \mbox{\hyperlink{loader_8h_a3d8d65e2de4c173a15a05a5d5dda60b8}{CSV\+\_\+\+MODE}}~\char`\"{}r\char`\"{}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
size\+\_\+t \mbox{\hyperlink{loader_8h_a22e9acd7bcdfe93ae43b91415fe1fe8f}{load\+\_\+mnist}} (const char $\ast$file, \mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$$\ast$$\ast$inputs, \mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$$\ast$$\ast$expected, size\+\_\+t start, size\+\_\+t length, const char $\ast$mode, size\+\_\+t inputsize, size\+\_\+t outputsize)
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{loader_8h_a399981b4dd18f0e6b9252badf307ce05}\label{loader_8h_a399981b4dd18f0e6b9252badf307ce05}} 
\index{loader.h@{loader.h}!BINARY\_MODE@{BINARY\_MODE}}
\index{BINARY\_MODE@{BINARY\_MODE}!loader.h@{loader.h}}
\doxysubsubsection{\texorpdfstring{BINARY\_MODE}{BINARY\_MODE}}
{\footnotesize\ttfamily \#define BINARY\+\_\+\+MODE~\char`\"{}rb\char`\"{}}



Definition at line 6 of file loader.\+h.

\mbox{\Hypertarget{loader_8h_a3d8d65e2de4c173a15a05a5d5dda60b8}\label{loader_8h_a3d8d65e2de4c173a15a05a5d5dda60b8}} 
\index{loader.h@{loader.h}!CSV\_MODE@{CSV\_MODE}}
\index{CSV\_MODE@{CSV\_MODE}!loader.h@{loader.h}}
\doxysubsubsection{\texorpdfstring{CSV\_MODE}{CSV\_MODE}}
{\footnotesize\ttfamily \#define CSV\+\_\+\+MODE~\char`\"{}r\char`\"{}}



Definition at line 7 of file loader.\+h.



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{loader_8h_a22e9acd7bcdfe93ae43b91415fe1fe8f}\label{loader_8h_a22e9acd7bcdfe93ae43b91415fe1fe8f}} 
\index{loader.h@{loader.h}!load\_mnist@{load\_mnist}}
\index{load\_mnist@{load\_mnist}!loader.h@{loader.h}}
\doxysubsubsection{\texorpdfstring{load\_mnist()}{load\_mnist()}}
{\footnotesize\ttfamily size\+\_\+t load\+\_\+mnist (\begin{DoxyParamCaption}\item[{const char $\ast$}]{file,  }\item[{\mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$$\ast$$\ast$}]{inputs,  }\item[{\mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$$\ast$$\ast$}]{expected,  }\item[{size\+\_\+t}]{start,  }\item[{size\+\_\+t}]{length,  }\item[{const char $\ast$}]{mode,  }\item[{size\+\_\+t}]{inputsize,  }\item[{size\+\_\+t}]{outputsize }\end{DoxyParamCaption})}



Definition at line 180 of file loader.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{183 \{}
\DoxyCodeLine{184 }
\DoxyCodeLine{185     \textcolor{keywordflow}{if} (strcmp(mode, \mbox{\hyperlink{loader_8h_a3d8d65e2de4c173a15a05a5d5dda60b8}{CSV\_MODE}}) \&\& strcmp(mode, \mbox{\hyperlink{loader_8h_a399981b4dd18f0e6b9252badf307ce05}{BINARY\_MODE}}))}
\DoxyCodeLine{186     \{}
\DoxyCodeLine{187         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{188     \}}
\DoxyCodeLine{189 }
\DoxyCodeLine{190     FILE *file = fopen(path, mode);}
\DoxyCodeLine{191     \textcolor{keywordflow}{if} (file == NULL)}
\DoxyCodeLine{192         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{193 }
\DoxyCodeLine{194     \textcolor{keywordflow}{if} (length == 0)}
\DoxyCodeLine{195     \{}
\DoxyCodeLine{196         *\_inputs = NULL;}
\DoxyCodeLine{197         *\_expected = NULL;}
\DoxyCodeLine{198         \textcolor{keywordflow}{if} (strcmp(mode, \mbox{\hyperlink{loader_8h_a3d8d65e2de4c173a15a05a5d5dda60b8}{CSV\_MODE}}) == 0)}
\DoxyCodeLine{199             length = load\_csv\_dynamic(}
\DoxyCodeLine{200                 file, \_inputs, \_expected, start, inputsize, outputsize);}
\DoxyCodeLine{201         \textcolor{keywordflow}{else}}
\DoxyCodeLine{202             length = 0;}
\DoxyCodeLine{203     \}}
\DoxyCodeLine{204     \textcolor{keywordflow}{else}}
\DoxyCodeLine{205     \{}
\DoxyCodeLine{206         *\_inputs = (\mbox{\hyperlink{structmatrix__t}{matrix\_t}} **)malloc(length * \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structmatrix__t}{matrix\_t}} *));}
\DoxyCodeLine{207         \textcolor{keywordflow}{if} (*\_inputs == NULL)}
\DoxyCodeLine{208             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{209         *\_expected = (\mbox{\hyperlink{structmatrix__t}{matrix\_t}} **)malloc(length * \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structmatrix__t}{matrix\_t}} *));}
\DoxyCodeLine{210         \textcolor{keywordflow}{if} (*\_expected == NULL)}
\DoxyCodeLine{211             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{212         init\_vectors(*\_expected, length, outputsize, 1);}
\DoxyCodeLine{213         init\_vectors(*\_inputs, length, inputsize, 0);}
\DoxyCodeLine{214         \textcolor{keywordflow}{if} (strcmp(mode, \mbox{\hyperlink{loader_8h_a3d8d65e2de4c173a15a05a5d5dda60b8}{CSV\_MODE}}) == 0)}
\DoxyCodeLine{215         \{}
\DoxyCodeLine{216             length = load\_csv(file, *\_inputs, *\_expected, start, length);}
\DoxyCodeLine{217         \}}
\DoxyCodeLine{218         \textcolor{keywordflow}{else}}
\DoxyCodeLine{219         \{}
\DoxyCodeLine{220             length = 0;}
\DoxyCodeLine{221         \}}
\DoxyCodeLine{222     \}}
\DoxyCodeLine{223 }
\DoxyCodeLine{224     fclose(file);}
\DoxyCodeLine{225     \textcolor{keywordflow}{return} length;}
\DoxyCodeLine{226 \}}

\end{DoxyCode}
