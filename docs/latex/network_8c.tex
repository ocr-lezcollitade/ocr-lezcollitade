\hypertarget{network_8c}{}\doxysection{src/network/network.c File Reference}
\label{network_8c}\index{src/network/network.c@{src/network/network.c}}
{\ttfamily \#include $<$err.\+h$>$}\newline
{\ttfamily \#include $<$malloc.\+h$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include \char`\"{}network.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}function.\+h\char`\"{}}\newline
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{network_8c_a28a631a46550a13bbf48635953aafcbd}{CHK}}(ptr,  function,  message)
\begin{DoxyCompactList}\small\item\em checks if a pointer is null. \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{network_8c_abd607f13447d238cfa36348ed8e5d383}{READ\+\_\+\+LENGTH}}~1024
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$ \mbox{\hyperlink{network_8c_a4ddc3e0dbc1979105df3cb54aea54319}{compute\+\_\+layer}} (\mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$values, \mbox{\hyperlink{structlayer__t}{layer\+\_\+t}} $\ast$layer, \mbox{\hyperlink{matrix_8h_af967065ada73d6d2c06c01459e274435}{mat\+\_\+transform\+\_\+t}} \mbox{\hyperlink{function_8h_a312ab1be52b156fb23e9345424c0f2b9}{activation}})
\item 
\mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$ \mbox{\hyperlink{network_8c_a49d5f5101cda3ffc8355a0237ee16709}{compute\+\_\+result}} (\mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$values, \mbox{\hyperlink{structnetwork__t}{network\+\_\+t}} $\ast$network)
\begin{DoxyCompactList}\small\item\em Computes the result of the input by the network. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{network_8c_ab872ac733c73ac5b412e9da46426a3ad}{compute\+\_\+result\+\_\+with\+\_\+save}} (\mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$$\ast$values, \mbox{\hyperlink{structnetwork__t}{network\+\_\+t}} $\ast$network)
\item 
\mbox{\hyperlink{structneuron__t}{neuron\+\_\+t}} $\ast$ \mbox{\hyperlink{network_8c_aa706a2634d39e1b59182ab9a9403931c}{neuron\+\_\+create}} (\mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$weights, double bias)
\begin{DoxyCompactList}\small\item\em Creates a neuron. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{network_8c_a634adde351458c2e8f8825c1816eeb43}{neuron\+\_\+free}} (\mbox{\hyperlink{structneuron__t}{neuron\+\_\+t}} $\ast$neuron)
\begin{DoxyCompactList}\small\item\em Frees the allocated neuron. \end{DoxyCompactList}\item 
\mbox{\hyperlink{structlayer__t}{layer\+\_\+t}} $\ast$ \mbox{\hyperlink{network_8c_adb61905641c2a84fe9cd88fb04672361}{layer\+\_\+create\+\_\+from\+\_\+mat}} (\mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$$\ast$weights, double $\ast$biases, size\+\_\+t count)
\begin{DoxyCompactList}\small\item\em Creates filled layer from an array of weights, and an array of biases. \end{DoxyCompactList}\item 
\mbox{\hyperlink{structlayer__t}{layer\+\_\+t}} $\ast$ \mbox{\hyperlink{network_8c_ad534d5135c47b2ae4f4637ddcde85205}{layer\+\_\+create}} (\mbox{\hyperlink{structneuron__t}{neuron\+\_\+t}} $\ast$$\ast$neurons, size\+\_\+t count)
\begin{DoxyCompactList}\small\item\em Creates a layer from an array of neurons. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{network_8c_ac0e36ece7ab68f5333223ea9167938d9}{layer\+\_\+free}} (\mbox{\hyperlink{structlayer__t}{layer\+\_\+t}} $\ast$layer)
\begin{DoxyCompactList}\small\item\em Frees an allocated layer. \end{DoxyCompactList}\item 
\mbox{\hyperlink{structnetwork__t}{network\+\_\+t}} $\ast$ \mbox{\hyperlink{network_8c_ad7ec187320facb456542975fd39de56e}{network\+\_\+create}} (\mbox{\hyperlink{structlayer__t}{layer\+\_\+t}} $\ast$$\ast$layers, size\+\_\+t layer\+\_\+count, size\+\_\+t inputs)
\begin{DoxyCompactList}\small\item\em Creates a network from an array of layers. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{network_8c_ab7de60cd0ad5a69e135b63d264018d1a}{network\+\_\+free}} (\mbox{\hyperlink{structnetwork__t}{network\+\_\+t}} $\ast$net)
\begin{DoxyCompactList}\small\item\em Frees the allocated network. \end{DoxyCompactList}\item 
\mbox{\hyperlink{structnetwork__t}{network\+\_\+t}} $\ast$ \mbox{\hyperlink{network_8c_a71f0aa4f7efea3ff158a49342228bb80}{network\+\_\+load}} (const char $\ast$path)
\begin{DoxyCompactList}\small\item\em Loads the network from a file. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{network_8c_aee995127aad46272ae3ddc5dfef07edc}{network\+\_\+save}} (const char $\ast$path, \mbox{\hyperlink{structnetwork__t}{network\+\_\+t}} $\ast$net)
\begin{DoxyCompactList}\small\item\em Saves a network to a file. \end{DoxyCompactList}\item 
\mbox{\hyperlink{structnetwork__t}{network\+\_\+t}} $\ast$ \mbox{\hyperlink{network_8c_aba00189ea608835915fdd9f753c33fd4}{network\+\_\+generate}} (size\+\_\+t $\ast$neuron\+\_\+count, size\+\_\+t size)
\begin{DoxyCompactList}\small\item\em Generates a network based on given neuron count. \end{DoxyCompactList}\item 
\mbox{\hyperlink{structnetwork__t}{network\+\_\+t}} $\ast$ \mbox{\hyperlink{network_8c_abef62369a77da828529fbf193f111ef7}{network\+\_\+copy}} (\mbox{\hyperlink{structnetwork__t}{network\+\_\+t}} $\ast$old)
\begin{DoxyCompactList}\small\item\em Create a deep copied network. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{network_8c_ac99789abdffa9915778914a50c1b4514}{network\+\_\+train}} (\mbox{\hyperlink{structnetwork__t}{network\+\_\+t}} $\ast$$\ast$pnet, \mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$inputs, \mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$target, double rate)
\item 
int \mbox{\hyperlink{network_8c_a338eaca7b062c45c2ddf651ec7bfb5ab}{network\+\_\+get\+\_\+output}} (\mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$outputs, double threshold)
\begin{DoxyCompactList}\small\item\em Return the calculated output. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{network_8c_a28a631a46550a13bbf48635953aafcbd}\label{network_8c_a28a631a46550a13bbf48635953aafcbd}} 
\index{network.c@{network.c}!CHK@{CHK}}
\index{CHK@{CHK}!network.c@{network.c}}
\doxysubsubsection{\texorpdfstring{CHK}{CHK}}
{\footnotesize\ttfamily \#define CHK(\begin{DoxyParamCaption}\item[{}]{ptr,  }\item[{}]{function,  }\item[{}]{message }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{    \{                                             \(\backslash\)}
\DoxyCodeLine{        if (ptr == NULL)                          \(\backslash\)}
\DoxyCodeLine{            errx(1, \textcolor{stringliteral}{"{}\%s: \%s"{}}, function, message); \(\backslash\)}
\DoxyCodeLine{    \}}

\end{DoxyCode}


checks if a pointer is null. 



Definition at line \mbox{\hyperlink{network_8c_source_l00008}{8}} of file \mbox{\hyperlink{network_8c_source}{network.\+c}}.

\mbox{\Hypertarget{network_8c_abd607f13447d238cfa36348ed8e5d383}\label{network_8c_abd607f13447d238cfa36348ed8e5d383}} 
\index{network.c@{network.c}!READ\_LENGTH@{READ\_LENGTH}}
\index{READ\_LENGTH@{READ\_LENGTH}!network.c@{network.c}}
\doxysubsubsection{\texorpdfstring{READ\_LENGTH}{READ\_LENGTH}}
{\footnotesize\ttfamily \#define READ\+\_\+\+LENGTH~1024}



Definition at line \mbox{\hyperlink{network_8c_source_l00141}{141}} of file \mbox{\hyperlink{network_8c_source}{network.\+c}}.



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{network_8c_a4ddc3e0dbc1979105df3cb54aea54319}\label{network_8c_a4ddc3e0dbc1979105df3cb54aea54319}} 
\index{network.c@{network.c}!compute\_layer@{compute\_layer}}
\index{compute\_layer@{compute\_layer}!network.c@{network.c}}
\doxysubsubsection{\texorpdfstring{compute\_layer()}{compute\_layer()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$ compute\+\_\+layer (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$}]{values,  }\item[{\mbox{\hyperlink{structlayer__t}{layer\+\_\+t}} $\ast$}]{layer,  }\item[{\mbox{\hyperlink{matrix_8h_af967065ada73d6d2c06c01459e274435}{mat\+\_\+transform\+\_\+t}}}]{activation }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{network_8c_source_l00014}{14}} of file \mbox{\hyperlink{network_8c_source}{network.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00016 \{}
\DoxyCodeLine{00017     \mbox{\hyperlink{structmatrix__t}{matrix\_t}} *result = \mbox{\hyperlink{matrix_8c_a1d9b061fc8856e727f014c3266b7431d}{matrix\_create}}(layer-\/>\mbox{\hyperlink{structlayer__t_a79cee7069a84d7440d56779ba2c073fb}{count}}, 1, 0);}
\DoxyCodeLine{00018     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < layer-\/>\mbox{\hyperlink{structlayer__t_a79cee7069a84d7440d56779ba2c073fb}{count}}; i++)}
\DoxyCodeLine{00019     \{}
\DoxyCodeLine{00020         \mbox{\hyperlink{structneuron__t}{neuron\_t}} *neuron = layer-\/>\mbox{\hyperlink{structlayer__t_a71e4f1a74c73f54b7ff2c40dc88c795e}{neurons}}[i];}
\DoxyCodeLine{00021         \mbox{\hyperlink{structmatrix__t}{matrix\_t}} *tmp = \mbox{\hyperlink{matrix_8c_aec843b4f924ae1c524b4f3e3dcc0ceda}{mat\_product}}(neuron-\/>\mbox{\hyperlink{structneuron__t_a6182effa3a478564d7dcd7f9d856c029}{weights}}, values);}
\DoxyCodeLine{00022         \textcolor{keywordtype}{double} postres = \mbox{\hyperlink{matrix_8c_a631ff21351ba5ec31350fb5277605d3b}{mat\_el\_at}}(tmp, 0, 0) + neuron-\/>\mbox{\hyperlink{structneuron__t_ad82dab1b1a60940e62e80270ad99a522}{bias}};}
\DoxyCodeLine{00023         postres = \mbox{\hyperlink{function_8c_a312ab1be52b156fb23e9345424c0f2b9}{activation}}(postres);}
\DoxyCodeLine{00024         \mbox{\hyperlink{matrix_8c_aa20fd2a5c773eda620ce98e2f121b687}{matrix\_free}}(tmp);}
\DoxyCodeLine{00025         \mbox{\hyperlink{matrix_8c_a0e411263cdaaa67eae166d067996f5b6}{mat\_set\_el}}(result, i, 0, postres);}
\DoxyCodeLine{00026     \}}
\DoxyCodeLine{00027 }
\DoxyCodeLine{00028     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{00029 \}}

\end{DoxyCode}
\mbox{\Hypertarget{network_8c_a49d5f5101cda3ffc8355a0237ee16709}\label{network_8c_a49d5f5101cda3ffc8355a0237ee16709}} 
\index{network.c@{network.c}!compute\_result@{compute\_result}}
\index{compute\_result@{compute\_result}!network.c@{network.c}}
\doxysubsubsection{\texorpdfstring{compute\_result()}{compute\_result()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$ compute\+\_\+result (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$}]{inputs,  }\item[{\mbox{\hyperlink{structnetwork__t}{network\+\_\+t}} $\ast$}]{network }\end{DoxyParamCaption})}



Computes the result of the input by the network. 


\begin{DoxyParams}{Parameters}
{\em inputs} & The column vector of the values. \\
\hline
{\em network} & The network to apply the values to. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The column vector of the computed results. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{network_8c_source_l00031}{31}} of file \mbox{\hyperlink{network_8c_source}{network.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00032 \{}
\DoxyCodeLine{00033     \mbox{\hyperlink{structmatrix__t}{matrix\_t}} *lastResults = \mbox{\hyperlink{matrix_8c_ad4970f9c83f185813ab569266c4fd0de}{mat\_copy}}(values);}
\DoxyCodeLine{00034     \textcolor{keywordtype}{size\_t} i;}
\DoxyCodeLine{00035     \textcolor{keywordflow}{for} (i = 0; i < network-\/>\mbox{\hyperlink{structnetwork__t_ad5fc71e5df50072d2c5a9ebfb28c7636}{layer\_count}} -\/ 1; i++)}
\DoxyCodeLine{00036     \{}
\DoxyCodeLine{00037         \mbox{\hyperlink{structlayer__t}{layer\_t}} *layer = network-\/>\mbox{\hyperlink{structnetwork__t_abc9801a33bc441d67a87fac3b603ae87}{layers}}[i];}
\DoxyCodeLine{00038         \mbox{\hyperlink{structmatrix__t}{matrix\_t}} *tmp = \mbox{\hyperlink{network_8c_a4ddc3e0dbc1979105df3cb54aea54319}{compute\_layer}}(lastResults, layer, \mbox{\hyperlink{function_8c_a312ab1be52b156fb23e9345424c0f2b9}{activation}});}
\DoxyCodeLine{00039         \mbox{\hyperlink{matrix_8c_aa20fd2a5c773eda620ce98e2f121b687}{matrix\_free}}(lastResults);}
\DoxyCodeLine{00040         lastResults = tmp;}
\DoxyCodeLine{00041     \}}
\DoxyCodeLine{00042 }
\DoxyCodeLine{00043     \mbox{\hyperlink{structlayer__t}{layer\_t}} *layer = network-\/>\mbox{\hyperlink{structnetwork__t_abc9801a33bc441d67a87fac3b603ae87}{layers}}[i];}
\DoxyCodeLine{00044     \mbox{\hyperlink{structmatrix__t}{matrix\_t}} *tmp = \mbox{\hyperlink{network_8c_a4ddc3e0dbc1979105df3cb54aea54319}{compute\_layer}}(lastResults, layer, \mbox{\hyperlink{function_8c_a4d12a97f68909050581df67de609d271}{output\_activation}});}
\DoxyCodeLine{00045     \mbox{\hyperlink{matrix_8c_aa20fd2a5c773eda620ce98e2f121b687}{matrix\_free}}(lastResults);}
\DoxyCodeLine{00046     lastResults = tmp;}
\DoxyCodeLine{00047 }
\DoxyCodeLine{00048     \textcolor{keywordflow}{return} lastResults;}
\DoxyCodeLine{00049 \}}

\end{DoxyCode}
\mbox{\Hypertarget{network_8c_ab872ac733c73ac5b412e9da46426a3ad}\label{network_8c_ab872ac733c73ac5b412e9da46426a3ad}} 
\index{network.c@{network.c}!compute\_result\_with\_save@{compute\_result\_with\_save}}
\index{compute\_result\_with\_save@{compute\_result\_with\_save}!network.c@{network.c}}
\doxysubsubsection{\texorpdfstring{compute\_result\_with\_save()}{compute\_result\_with\_save()}}
{\footnotesize\ttfamily void compute\+\_\+result\+\_\+with\+\_\+save (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$$\ast$}]{values,  }\item[{\mbox{\hyperlink{structnetwork__t}{network\+\_\+t}} $\ast$}]{network }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{network_8c_source_l00051}{51}} of file \mbox{\hyperlink{network_8c_source}{network.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00052 \{}
\DoxyCodeLine{00053     \textcolor{keywordtype}{size\_t} i;}
\DoxyCodeLine{00054     \textcolor{keywordflow}{for} (i = 0; i < network-\/>\mbox{\hyperlink{structnetwork__t_ad5fc71e5df50072d2c5a9ebfb28c7636}{layer\_count}} -\/ 1; i++)}
\DoxyCodeLine{00055     \{}
\DoxyCodeLine{00056         \mbox{\hyperlink{structlayer__t}{layer\_t}} *layer = network-\/>\mbox{\hyperlink{structnetwork__t_abc9801a33bc441d67a87fac3b603ae87}{layers}}[i];}
\DoxyCodeLine{00057         values[i + 1] = \mbox{\hyperlink{network_8c_a4ddc3e0dbc1979105df3cb54aea54319}{compute\_layer}}(values[i], layer, \mbox{\hyperlink{function_8c_a312ab1be52b156fb23e9345424c0f2b9}{activation}});}
\DoxyCodeLine{00058     \}}
\DoxyCodeLine{00059 }
\DoxyCodeLine{00060     \mbox{\hyperlink{structlayer__t}{layer\_t}} *layer = network-\/>\mbox{\hyperlink{structnetwork__t_abc9801a33bc441d67a87fac3b603ae87}{layers}}[i];}
\DoxyCodeLine{00061     values[i + 1] = \mbox{\hyperlink{network_8c_a4ddc3e0dbc1979105df3cb54aea54319}{compute\_layer}}(values[i], layer, \mbox{\hyperlink{function_8c_a4d12a97f68909050581df67de609d271}{output\_activation}});}
\DoxyCodeLine{00062 \}}

\end{DoxyCode}
\mbox{\Hypertarget{network_8c_ad534d5135c47b2ae4f4637ddcde85205}\label{network_8c_ad534d5135c47b2ae4f4637ddcde85205}} 
\index{network.c@{network.c}!layer\_create@{layer\_create}}
\index{layer\_create@{layer\_create}!network.c@{network.c}}
\doxysubsubsection{\texorpdfstring{layer\_create()}{layer\_create()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structlayer__t}{layer\+\_\+t}} $\ast$ layer\+\_\+create (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structneuron__t}{neuron\+\_\+t}} $\ast$$\ast$}]{neurons,  }\item[{size\+\_\+t}]{count }\end{DoxyParamCaption})}



Creates a layer from an array of neurons. 


\begin{DoxyParams}{Parameters}
{\em neurons} & The array of neurons in the layer. \\
\hline
{\em count} & The count of neurons in the layer. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The created layer. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{network_8c_source_l00097}{97}} of file \mbox{\hyperlink{network_8c_source}{network.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00098 \{}
\DoxyCodeLine{00099     \mbox{\hyperlink{structlayer__t}{layer\_t}} *layer = (\mbox{\hyperlink{structlayer__t}{layer\_t}} *)malloc(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structlayer__t}{layer\_t}}));}
\DoxyCodeLine{00100     \textcolor{keywordflow}{if} (layer == NULL)}
\DoxyCodeLine{00101         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{00102     layer-\/>\mbox{\hyperlink{structlayer__t_a71e4f1a74c73f54b7ff2c40dc88c795e}{neurons}} = neurons;}
\DoxyCodeLine{00103     layer-\/>\mbox{\hyperlink{structlayer__t_a79cee7069a84d7440d56779ba2c073fb}{count}} = count;}
\DoxyCodeLine{00104 }
\DoxyCodeLine{00105     \textcolor{keywordflow}{return} layer;}
\DoxyCodeLine{00106 \}}

\end{DoxyCode}
\mbox{\Hypertarget{network_8c_adb61905641c2a84fe9cd88fb04672361}\label{network_8c_adb61905641c2a84fe9cd88fb04672361}} 
\index{network.c@{network.c}!layer\_create\_from\_mat@{layer\_create\_from\_mat}}
\index{layer\_create\_from\_mat@{layer\_create\_from\_mat}!network.c@{network.c}}
\doxysubsubsection{\texorpdfstring{layer\_create\_from\_mat()}{layer\_create\_from\_mat()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structlayer__t}{layer\+\_\+t}} $\ast$ layer\+\_\+create\+\_\+from\+\_\+mat (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$$\ast$}]{weights,  }\item[{double $\ast$}]{biases,  }\item[{size\+\_\+t}]{count }\end{DoxyParamCaption})}



Creates filled layer from an array of weights, and an array of biases. 


\begin{DoxyParams}{Parameters}
{\em weights} & The array of weights for each neuron in the layer. \\
\hline
{\em biases} & The array of biases for each neuron in the layer. \\
\hline
{\em count} & The number of elements to be created, hence the size of weights and biases. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The created layer. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{network_8c_source_l00081}{81}} of file \mbox{\hyperlink{network_8c_source}{network.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00083 \{}
\DoxyCodeLine{00084     \mbox{\hyperlink{structlayer__t}{layer\_t}} *layer = (\mbox{\hyperlink{structlayer__t}{layer\_t}} *)malloc(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structlayer__t}{layer\_t}}));}
\DoxyCodeLine{00085     \textcolor{keywordflow}{if} (layer == NULL)}
\DoxyCodeLine{00086         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{00087     layer-\/>\mbox{\hyperlink{structlayer__t_a79cee7069a84d7440d56779ba2c073fb}{count}} = count;}
\DoxyCodeLine{00088     layer-\/>\mbox{\hyperlink{structlayer__t_a71e4f1a74c73f54b7ff2c40dc88c795e}{neurons}} = (\mbox{\hyperlink{structneuron__t}{neuron\_t}} **)malloc(count * \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structneuron__t}{neuron\_t}} *));}
\DoxyCodeLine{00089     \textcolor{keywordflow}{if} (layer-\/>\mbox{\hyperlink{structlayer__t_a71e4f1a74c73f54b7ff2c40dc88c795e}{neurons}} == NULL)}
\DoxyCodeLine{00090         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{00091     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < count; i++)}
\DoxyCodeLine{00092         layer-\/>\mbox{\hyperlink{structlayer__t_a71e4f1a74c73f54b7ff2c40dc88c795e}{neurons}}[i] = \mbox{\hyperlink{network_8c_aa706a2634d39e1b59182ab9a9403931c}{neuron\_create}}(weights[i], biases[i]);}
\DoxyCodeLine{00093 }
\DoxyCodeLine{00094     \textcolor{keywordflow}{return} layer;}
\DoxyCodeLine{00095 \}}

\end{DoxyCode}
\mbox{\Hypertarget{network_8c_ac0e36ece7ab68f5333223ea9167938d9}\label{network_8c_ac0e36ece7ab68f5333223ea9167938d9}} 
\index{network.c@{network.c}!layer\_free@{layer\_free}}
\index{layer\_free@{layer\_free}!network.c@{network.c}}
\doxysubsubsection{\texorpdfstring{layer\_free()}{layer\_free()}}
{\footnotesize\ttfamily void layer\+\_\+free (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structlayer__t}{layer\+\_\+t}} $\ast$}]{layer }\end{DoxyParamCaption})}



Frees an allocated layer. 


\begin{DoxyParams}{Parameters}
{\em layer} & The layer to be freed. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{network_8c_source_l00108}{108}} of file \mbox{\hyperlink{network_8c_source}{network.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00109 \{}
\DoxyCodeLine{00110     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < layer-\/>\mbox{\hyperlink{structlayer__t_a79cee7069a84d7440d56779ba2c073fb}{count}}; i++)}
\DoxyCodeLine{00111     \{}
\DoxyCodeLine{00112         \mbox{\hyperlink{network_8c_a634adde351458c2e8f8825c1816eeb43}{neuron\_free}}(layer-\/>\mbox{\hyperlink{structlayer__t_a71e4f1a74c73f54b7ff2c40dc88c795e}{neurons}}[i]);}
\DoxyCodeLine{00113     \}}
\DoxyCodeLine{00114 }
\DoxyCodeLine{00115     free(layer-\/>\mbox{\hyperlink{structlayer__t_a71e4f1a74c73f54b7ff2c40dc88c795e}{neurons}});}
\DoxyCodeLine{00116     free(layer);}
\DoxyCodeLine{00117 \}}

\end{DoxyCode}
\mbox{\Hypertarget{network_8c_abef62369a77da828529fbf193f111ef7}\label{network_8c_abef62369a77da828529fbf193f111ef7}} 
\index{network.c@{network.c}!network\_copy@{network\_copy}}
\index{network\_copy@{network\_copy}!network.c@{network.c}}
\doxysubsubsection{\texorpdfstring{network\_copy()}{network\_copy()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structnetwork__t}{network\+\_\+t}} $\ast$ network\+\_\+copy (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structnetwork__t}{network\+\_\+t}} $\ast$}]{old }\end{DoxyParamCaption})}



Create a deep copied network. 


\begin{DoxyParams}{Parameters}
{\em old} & The network to copy. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The copied network. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{network_8c_source_l00515}{515}} of file \mbox{\hyperlink{network_8c_source}{network.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00516 \{}
\DoxyCodeLine{00517     \mbox{\hyperlink{structlayer__t}{layer\_t}} **layers}
\DoxyCodeLine{00518         = (\mbox{\hyperlink{structlayer__t}{layer\_t}} **)malloc(old-\/>\mbox{\hyperlink{structnetwork__t_ad5fc71e5df50072d2c5a9ebfb28c7636}{layer\_count}} * \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structlayer__t}{layer\_t}} *));}
\DoxyCodeLine{00519     \mbox{\hyperlink{structnetwork__t}{network\_t}} *res = \mbox{\hyperlink{network_8c_ad7ec187320facb456542975fd39de56e}{network\_create}}(layers, old-\/>\mbox{\hyperlink{structnetwork__t_ad5fc71e5df50072d2c5a9ebfb28c7636}{layer\_count}}, old-\/>\mbox{\hyperlink{structnetwork__t_af7a2fbc049a0fd2d5ad14f218658ca83}{inputs}});}
\DoxyCodeLine{00520     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < old-\/>\mbox{\hyperlink{structnetwork__t_ad5fc71e5df50072d2c5a9ebfb28c7636}{layer\_count}}; i++)}
\DoxyCodeLine{00521     \{}
\DoxyCodeLine{00522         layers[i] = layer\_copy(old-\/>\mbox{\hyperlink{structnetwork__t_abc9801a33bc441d67a87fac3b603ae87}{layers}}[i]);}
\DoxyCodeLine{00523     \}}
\DoxyCodeLine{00524 }
\DoxyCodeLine{00525     \textcolor{keywordflow}{return} res;}
\DoxyCodeLine{00526 \}}

\end{DoxyCode}
\mbox{\Hypertarget{network_8c_ad7ec187320facb456542975fd39de56e}\label{network_8c_ad7ec187320facb456542975fd39de56e}} 
\index{network.c@{network.c}!network\_create@{network\_create}}
\index{network\_create@{network\_create}!network.c@{network.c}}
\doxysubsubsection{\texorpdfstring{network\_create()}{network\_create()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structnetwork__t}{network\+\_\+t}} $\ast$ network\+\_\+create (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structlayer__t}{layer\+\_\+t}} $\ast$$\ast$}]{layers,  }\item[{size\+\_\+t}]{size,  }\item[{size\+\_\+t}]{inputs }\end{DoxyParamCaption})}



Creates a network from an array of layers. 


\begin{DoxyParams}{Parameters}
{\em layers} & The array of layers in the network. \\
\hline
{\em size} & The number of layers in the array. \\
\hline
{\em inputs} & The number of neurons in the input layer. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The created network. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{network_8c_source_l00119}{119}} of file \mbox{\hyperlink{network_8c_source}{network.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00120 \{}
\DoxyCodeLine{00121     \mbox{\hyperlink{structnetwork__t}{network\_t}} *res = (\mbox{\hyperlink{structnetwork__t}{network\_t}} *)malloc(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structnetwork__t}{network\_t}}));}
\DoxyCodeLine{00122     \textcolor{keywordflow}{if} (res == NULL)}
\DoxyCodeLine{00123         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{00124     res-\/>\mbox{\hyperlink{structnetwork__t_abc9801a33bc441d67a87fac3b603ae87}{layers}} = layers;}
\DoxyCodeLine{00125     res-\/>\mbox{\hyperlink{structnetwork__t_af7a2fbc049a0fd2d5ad14f218658ca83}{inputs}} = inputs;}
\DoxyCodeLine{00126     res-\/>\mbox{\hyperlink{structnetwork__t_ad5fc71e5df50072d2c5a9ebfb28c7636}{layer\_count}} = layer\_count;}
\DoxyCodeLine{00127     \textcolor{keywordflow}{return} res;}
\DoxyCodeLine{00128 \}}

\end{DoxyCode}
\mbox{\Hypertarget{network_8c_ab7de60cd0ad5a69e135b63d264018d1a}\label{network_8c_ab7de60cd0ad5a69e135b63d264018d1a}} 
\index{network.c@{network.c}!network\_free@{network\_free}}
\index{network\_free@{network\_free}!network.c@{network.c}}
\doxysubsubsection{\texorpdfstring{network\_free()}{network\_free()}}
{\footnotesize\ttfamily void network\+\_\+free (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structnetwork__t}{network\+\_\+t}} $\ast$}]{network }\end{DoxyParamCaption})}



Frees the allocated network. 


\begin{DoxyParams}{Parameters}
{\em network} & The network to be freed. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{network_8c_source_l00130}{130}} of file \mbox{\hyperlink{network_8c_source}{network.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00131 \{}
\DoxyCodeLine{00132     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < net-\/>layer\_count; i++)}
\DoxyCodeLine{00133     \{}
\DoxyCodeLine{00134         \mbox{\hyperlink{network_8c_ac0e36ece7ab68f5333223ea9167938d9}{layer\_free}}(net-\/>layers[i]);}
\DoxyCodeLine{00135     \}}
\DoxyCodeLine{00136 }
\DoxyCodeLine{00137     free(net-\/>layers);}
\DoxyCodeLine{00138     free(net);}
\DoxyCodeLine{00139 \}}

\end{DoxyCode}
\mbox{\Hypertarget{network_8c_aba00189ea608835915fdd9f753c33fd4}\label{network_8c_aba00189ea608835915fdd9f753c33fd4}} 
\index{network.c@{network.c}!network\_generate@{network\_generate}}
\index{network\_generate@{network\_generate}!network.c@{network.c}}
\doxysubsubsection{\texorpdfstring{network\_generate()}{network\_generate()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structnetwork__t}{network\+\_\+t}} $\ast$ network\+\_\+generate (\begin{DoxyParamCaption}\item[{size\+\_\+t $\ast$}]{neurons,  }\item[{size\+\_\+t}]{size }\end{DoxyParamCaption})}



Generates a network based on given neuron count. 


\begin{DoxyParams}{Parameters}
{\em neurons} & An array containing the number of neurons at each layer including input layer.\\
\hline
{\em size} & The length of the array, hence the number of layers plus the input layer. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The generated network. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{network_8c_source_l00472}{472}} of file \mbox{\hyperlink{network_8c_source}{network.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00473 \{}
\DoxyCodeLine{00474     \textcolor{keywordflow}{if} (size < 2)}
\DoxyCodeLine{00475         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{00476     \mbox{\hyperlink{structlayer__t}{layer\_t}} **layers = (\mbox{\hyperlink{structlayer__t}{layer\_t}} **)malloc((size -\/ 1) * \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structlayer__t}{layer\_t}} *));}
\DoxyCodeLine{00477     \textcolor{keywordtype}{size\_t} weights = neuron\_count[0];}
\DoxyCodeLine{00478     \mbox{\hyperlink{structnetwork__t}{network\_t}} *res = \mbox{\hyperlink{network_8c_ad7ec187320facb456542975fd39de56e}{network\_create}}(layers, size -\/ 1, weights);}
\DoxyCodeLine{00479 }
\DoxyCodeLine{00480     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 1; i < size; i++)}
\DoxyCodeLine{00481     \{}
\DoxyCodeLine{00482         \textcolor{keywordtype}{size\_t} n\_count = neuron\_count[i];}
\DoxyCodeLine{00483         \mbox{\hyperlink{structneuron__t}{neuron\_t}} **neurons = (\mbox{\hyperlink{structneuron__t}{neuron\_t}} **)malloc(n\_count * \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structneuron__t}{neuron\_t}} *));}
\DoxyCodeLine{00484         \mbox{\hyperlink{structlayer__t}{layer\_t}} *layer = \mbox{\hyperlink{network_8c_ad534d5135c47b2ae4f4637ddcde85205}{layer\_create}}(neurons, n\_count);}
\DoxyCodeLine{00485         layers[i -\/ 1] = layer;}
\DoxyCodeLine{00486         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} ni = 0; ni < n\_count; ni++)}
\DoxyCodeLine{00487         \{}
\DoxyCodeLine{00488             \textcolor{keywordtype}{double} *values = \mbox{\hyperlink{function_8c_ae6d5ccd297429cb956c9a4deb3d5daa8}{generate\_weights}}(weights + 1);}
\DoxyCodeLine{00489             layers[i -\/ 1]-\/>\mbox{\hyperlink{structlayer__t_a71e4f1a74c73f54b7ff2c40dc88c795e}{neurons}}[ni] = parse\_results(values, weights);}
\DoxyCodeLine{00490             free(values);}
\DoxyCodeLine{00491         \}}
\DoxyCodeLine{00492         weights = n\_count;}
\DoxyCodeLine{00493     \}}
\DoxyCodeLine{00494 }
\DoxyCodeLine{00495     \textcolor{keywordflow}{return} res;}
\DoxyCodeLine{00496 \}}

\end{DoxyCode}
\mbox{\Hypertarget{network_8c_a338eaca7b062c45c2ddf651ec7bfb5ab}\label{network_8c_a338eaca7b062c45c2ddf651ec7bfb5ab}} 
\index{network.c@{network.c}!network\_get\_output@{network\_get\_output}}
\index{network\_get\_output@{network\_get\_output}!network.c@{network.c}}
\doxysubsubsection{\texorpdfstring{network\_get\_output()}{network\_get\_output()}}
{\footnotesize\ttfamily int network\+\_\+get\+\_\+output (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$}]{outputs,  }\item[{double}]{threshold }\end{DoxyParamCaption})}



Return the calculated output. 


\begin{DoxyParams}{Parameters}
{\em outputs} & The matrix of outputs given by the network. \\
\hline
{\em threshold} & The threshold starting from which the result will be considered as valid. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The calculated output or -\/1 if none above the threshold. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{network_8c_source_l00634}{634}} of file \mbox{\hyperlink{network_8c_source}{network.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00635 \{}
\DoxyCodeLine{00636     \textcolor{keywordtype}{int} result = -\/1;}
\DoxyCodeLine{00637     \textcolor{keywordtype}{double} old\_value = 0;}
\DoxyCodeLine{00638     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} i = 0; i < outputs-\/>\mbox{\hyperlink{structmatrix__t_a9620f15b4416ec1830196db9ec904fc5}{rows}}; i++) \{}
\DoxyCodeLine{00639         \textcolor{keywordtype}{double} val = \mbox{\hyperlink{matrix_8c_a631ff21351ba5ec31350fb5277605d3b}{mat\_el\_at}}(outputs, i, 0);}
\DoxyCodeLine{00640         \textcolor{keywordflow}{if}(val < threshold)}
\DoxyCodeLine{00641             \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00642         \textcolor{keywordflow}{if}(val > old\_value) \{}
\DoxyCodeLine{00643             result = i;}
\DoxyCodeLine{00644             old\_value = val;}
\DoxyCodeLine{00645         \}}
\DoxyCodeLine{00646     \}}
\DoxyCodeLine{00647 }
\DoxyCodeLine{00648     \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{00649 \}}

\end{DoxyCode}
\mbox{\Hypertarget{network_8c_a71f0aa4f7efea3ff158a49342228bb80}\label{network_8c_a71f0aa4f7efea3ff158a49342228bb80}} 
\index{network.c@{network.c}!network\_load@{network\_load}}
\index{network\_load@{network\_load}!network.c@{network.c}}
\doxysubsubsection{\texorpdfstring{network\_load()}{network\_load()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structnetwork__t}{network\+\_\+t}} $\ast$ network\+\_\+load (\begin{DoxyParamCaption}\item[{const char $\ast$}]{file }\end{DoxyParamCaption})}



Loads the network from a file. 


\begin{DoxyParams}{Parameters}
{\em file} & The path of the file to load. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The loaded network. The file format\+: The file will start with two comma-\/separated integer indicating the number of layers and the number of input neurons. Each layer will start by the number of neurons in the layer. Then each neuron information will be seperated by a newline char. Neuron format\+: $<$weight1$>$, ... , $<$weightn$>$, $<$bias$>$ Example for xor network with random biases and weights\+: 2,2 \# The number of layers and the number of input neurons. 2 \# The number of neurons in layer 1 1,1,-\/0.\+5 \# neuron 1,1 weights are \mbox{[}1, 1\mbox{]} and the bias is -\/0.\+5 -\/1,-\/1,1.\+5 1 \# The number of neurons in layer 2 1, 1, 0.\+5 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{network_8c_source_l00381}{381}} of file \mbox{\hyperlink{network_8c_source}{network.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00382 \{}
\DoxyCodeLine{00383     \textcolor{comment}{// open the file}}
\DoxyCodeLine{00384     FILE *file = fopen(path, \textcolor{stringliteral}{"{}r"{}});}
\DoxyCodeLine{00385     \mbox{\hyperlink{network_8c_a28a631a46550a13bbf48635953aafcbd}{CHK}}(file, \textcolor{stringliteral}{"{}network\_load"{}}, \textcolor{stringliteral}{"{}could not open file"{}});}
\DoxyCodeLine{00386 }
\DoxyCodeLine{00387     \textcolor{keywordtype}{size\_t} layer\_count, weight\_count, neuron\_count = 0;}
\DoxyCodeLine{00388     \textcolor{keywordtype}{size\_t} neuron\_index = 0, layer\_index = 0;}
\DoxyCodeLine{00389     \textcolor{keywordtype}{int} in\_layer = 0;}
\DoxyCodeLine{00390     \textcolor{keywordtype}{size\_t} line = 0;}
\DoxyCodeLine{00391     \textcolor{keywordtype}{int} alive = parse\_header(file, \&layer\_count, \&neuron\_count, \&line);}
\DoxyCodeLine{00392     line++;}
\DoxyCodeLine{00393     \textcolor{keywordflow}{if} (!alive)}
\DoxyCodeLine{00394         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{00395 }
\DoxyCodeLine{00396     \mbox{\hyperlink{structlayer__t}{layer\_t}} **layers = (\mbox{\hyperlink{structlayer__t}{layer\_t}} **)malloc(layer\_count * \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structlayer__t}{layer\_t}} *));}
\DoxyCodeLine{00397     \mbox{\hyperlink{structnetwork__t}{network\_t}} *res = \mbox{\hyperlink{network_8c_ad7ec187320facb456542975fd39de56e}{network\_create}}(layers, layer\_count, neuron\_count);}
\DoxyCodeLine{00398     \textcolor{keywordtype}{double} *values;}
\DoxyCodeLine{00399     \textcolor{keywordflow}{while} (layer\_index < layer\_count)}
\DoxyCodeLine{00400     \{}
\DoxyCodeLine{00401         \textcolor{keywordflow}{if} (!in\_layer)}
\DoxyCodeLine{00402         \{}
\DoxyCodeLine{00403             weight\_count = neuron\_count;}
\DoxyCodeLine{00404             alive = parse\_layer\_header(file, \&neuron\_count, \&line);}
\DoxyCodeLine{00405             line++;}
\DoxyCodeLine{00406             neuron\_index = 0;}
\DoxyCodeLine{00407             in\_layer = 1;}
\DoxyCodeLine{00408             layers[layer\_index] = \mbox{\hyperlink{network_8c_ad534d5135c47b2ae4f4637ddcde85205}{layer\_create}}(}
\DoxyCodeLine{00409                 (\mbox{\hyperlink{structneuron__t}{neuron\_t}} **)malloc(neuron\_count * \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structneuron__t}{neuron\_t}} *)),}
\DoxyCodeLine{00410                 neuron\_count);}
\DoxyCodeLine{00411         \}}
\DoxyCodeLine{00412         \textcolor{keywordflow}{else}}
\DoxyCodeLine{00413         \{}
\DoxyCodeLine{00414             \textcolor{keywordflow}{if} (neuron\_count == neuron\_index)}
\DoxyCodeLine{00415             \{}
\DoxyCodeLine{00416                 in\_layer = 0;}
\DoxyCodeLine{00417                 layer\_index++;}
\DoxyCodeLine{00418             \}}
\DoxyCodeLine{00419             \textcolor{keywordflow}{else}}
\DoxyCodeLine{00420             \{}
\DoxyCodeLine{00421                 values = (\textcolor{keywordtype}{double} *)malloc((weight\_count + 1) * \textcolor{keyword}{sizeof}(double));}
\DoxyCodeLine{00422                 alive}
\DoxyCodeLine{00423                     = parse\_neuron\_line(file, values, weight\_count + 1, \&line);}
\DoxyCodeLine{00424                 line++;}
\DoxyCodeLine{00425                 layers[layer\_index]-\/>\mbox{\hyperlink{structlayer__t_a71e4f1a74c73f54b7ff2c40dc88c795e}{neurons}}[neuron\_index]}
\DoxyCodeLine{00426                     = parse\_results(values, weight\_count);}
\DoxyCodeLine{00427                 free(values);}
\DoxyCodeLine{00428                 neuron\_index++;}
\DoxyCodeLine{00429             \}}
\DoxyCodeLine{00430         \}}
\DoxyCodeLine{00431     \}}
\DoxyCodeLine{00432     \textcolor{comment}{// close the file}}
\DoxyCodeLine{00433     fclose(file);}
\DoxyCodeLine{00434     \textcolor{keywordflow}{return} res;}
\DoxyCodeLine{00435 \}}

\end{DoxyCode}
\mbox{\Hypertarget{network_8c_aee995127aad46272ae3ddc5dfef07edc}\label{network_8c_aee995127aad46272ae3ddc5dfef07edc}} 
\index{network.c@{network.c}!network\_save@{network\_save}}
\index{network\_save@{network\_save}!network.c@{network.c}}
\doxysubsubsection{\texorpdfstring{network\_save()}{network\_save()}}
{\footnotesize\ttfamily void network\+\_\+save (\begin{DoxyParamCaption}\item[{const char $\ast$}]{file,  }\item[{\mbox{\hyperlink{structnetwork__t}{network\+\_\+t}} $\ast$}]{network }\end{DoxyParamCaption})}



Saves a network to a file. 


\begin{DoxyParams}{Parameters}
{\em file} & The file to save the network to. \\
\hline
{\em network} & The network to be saved. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{network_8c_source_l00457}{457}} of file \mbox{\hyperlink{network_8c_source}{network.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00458 \{}
\DoxyCodeLine{00459     FILE *file = fopen(path, \textcolor{stringliteral}{"{}w"{}});}
\DoxyCodeLine{00460     \mbox{\hyperlink{network_8c_a28a631a46550a13bbf48635953aafcbd}{CHK}}(file, \textcolor{stringliteral}{"{}network\_save"{}}, \textcolor{stringliteral}{"{}could not open file"{}});}
\DoxyCodeLine{00461     fprintf(file, \textcolor{stringliteral}{"{}\%zu, \%zu\(\backslash\)n"{}}, net-\/>layer\_count, net-\/>inputs);}
\DoxyCodeLine{00462     \textcolor{keywordtype}{size\_t} weight\_count = net-\/>inputs;}
\DoxyCodeLine{00463     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < net-\/>layer\_count; i++)}
\DoxyCodeLine{00464     \{}
\DoxyCodeLine{00465         fprintf(file, \textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{00466         layer\_save(file, net-\/>layers[i], weight\_count);}
\DoxyCodeLine{00467         weight\_count = net-\/>layers[i]-\/>count;}
\DoxyCodeLine{00468     \}}
\DoxyCodeLine{00469     fclose(file);}
\DoxyCodeLine{00470 \}}

\end{DoxyCode}
\mbox{\Hypertarget{network_8c_ac99789abdffa9915778914a50c1b4514}\label{network_8c_ac99789abdffa9915778914a50c1b4514}} 
\index{network.c@{network.c}!network\_train@{network\_train}}
\index{network\_train@{network\_train}!network.c@{network.c}}
\doxysubsubsection{\texorpdfstring{network\_train()}{network\_train()}}
{\footnotesize\ttfamily void network\+\_\+train (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structnetwork__t}{network\+\_\+t}} $\ast$$\ast$}]{pnet,  }\item[{\mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$}]{inputs,  }\item[{\mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$}]{target,  }\item[{double}]{rate }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{network_8c_source_l00594}{594}} of file \mbox{\hyperlink{network_8c_source}{network.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00596 \{}
\DoxyCodeLine{00597     \mbox{\hyperlink{structnetwork__t}{network\_t}} *trained = \mbox{\hyperlink{network_8c_abef62369a77da828529fbf193f111ef7}{network\_copy}}(*pnet);}
\DoxyCodeLine{00598 }
\DoxyCodeLine{00599     \mbox{\hyperlink{structmatrix__t}{matrix\_t}} **outputs}
\DoxyCodeLine{00600         = (\mbox{\hyperlink{structmatrix__t}{matrix\_t}} **)malloc(((*pnet)-\/>layer\_count + 1) * \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structmatrix__t}{matrix\_t}} *));}
\DoxyCodeLine{00601     outputs[0] = inputs;}
\DoxyCodeLine{00602 }
\DoxyCodeLine{00603     \mbox{\hyperlink{structmatrix__t}{matrix\_t}} **deltas}
\DoxyCodeLine{00604         = (\mbox{\hyperlink{structmatrix__t}{matrix\_t}} **)malloc((*pnet)-\/>layer\_count * \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structmatrix__t}{matrix\_t}} *));}
\DoxyCodeLine{00605 }
\DoxyCodeLine{00606     \mbox{\hyperlink{network_8c_ab872ac733c73ac5b412e9da46426a3ad}{compute\_result\_with\_save}}(outputs, *pnet);}
\DoxyCodeLine{00607 }
\DoxyCodeLine{00608     \textcolor{keywordtype}{size\_t} layer\_i = trained-\/>\mbox{\hyperlink{structnetwork__t_ad5fc71e5df50072d2c5a9ebfb28c7636}{layer\_count}} -\/ 1;}
\DoxyCodeLine{00609     \mbox{\hyperlink{structlayer__t}{layer\_t}} *trained\_layer = trained-\/>\mbox{\hyperlink{structnetwork__t_abc9801a33bc441d67a87fac3b603ae87}{layers}}[layer\_i];}
\DoxyCodeLine{00610     \mbox{\hyperlink{structlayer__t}{layer\_t}} *old\_layer = (*pnet)-\/>layers[layer\_i];}
\DoxyCodeLine{00611     deltas[layer\_i] = \mbox{\hyperlink{matrix_8c_a1d9b061fc8856e727f014c3266b7431d}{matrix\_create}}(trained\_layer-\/>\mbox{\hyperlink{structlayer__t_a79cee7069a84d7440d56779ba2c073fb}{count}}, 1, 0);}
\DoxyCodeLine{00612     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} ni = 0; ni < trained\_layer-\/>\mbox{\hyperlink{structlayer__t_a79cee7069a84d7440d56779ba2c073fb}{count}}; ni++)}
\DoxyCodeLine{00613     \{}
\DoxyCodeLine{00614         \textcolor{keywordtype}{double} delta = output\_neuron\_train(trained\_layer-\/>\mbox{\hyperlink{structlayer__t_a71e4f1a74c73f54b7ff2c40dc88c795e}{neurons}}[ni],}
\DoxyCodeLine{00615             old\_layer-\/>\mbox{\hyperlink{structlayer__t_a71e4f1a74c73f54b7ff2c40dc88c795e}{neurons}}[ni], rate, \mbox{\hyperlink{matrix_8c_a631ff21351ba5ec31350fb5277605d3b}{mat\_el\_at}}(target, ni, 0),}
\DoxyCodeLine{00616             \mbox{\hyperlink{matrix_8c_a631ff21351ba5ec31350fb5277605d3b}{mat\_el\_at}}(outputs[layer\_i + 1], ni, 0), outputs[layer\_i]);}
\DoxyCodeLine{00617         \mbox{\hyperlink{matrix_8c_a0e411263cdaaa67eae166d067996f5b6}{mat\_set\_el}}(deltas[layer\_i], ni, 0, delta);}
\DoxyCodeLine{00618     \}}
\DoxyCodeLine{00619 }
\DoxyCodeLine{00620     compute\_deltas(outputs, *pnet, deltas);}
\DoxyCodeLine{00621     hidden\_layer\_train(outputs, trained, deltas, rate);}
\DoxyCodeLine{00622 }
\DoxyCodeLine{00623     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 1; i <= trained-\/>\mbox{\hyperlink{structnetwork__t_ad5fc71e5df50072d2c5a9ebfb28c7636}{layer\_count}}; i++)}
\DoxyCodeLine{00624     \{}
\DoxyCodeLine{00625         \mbox{\hyperlink{matrix_8c_aa20fd2a5c773eda620ce98e2f121b687}{matrix\_free}}(outputs[i]);}
\DoxyCodeLine{00626         \mbox{\hyperlink{matrix_8c_aa20fd2a5c773eda620ce98e2f121b687}{matrix\_free}}(deltas[i -\/ 1]);}
\DoxyCodeLine{00627     \}}
\DoxyCodeLine{00628     free(outputs);}
\DoxyCodeLine{00629     free(deltas);}
\DoxyCodeLine{00630     \mbox{\hyperlink{network_8c_ab7de60cd0ad5a69e135b63d264018d1a}{network\_free}}(*pnet);}
\DoxyCodeLine{00631     *pnet = trained;}
\DoxyCodeLine{00632 \}}

\end{DoxyCode}
\mbox{\Hypertarget{network_8c_aa706a2634d39e1b59182ab9a9403931c}\label{network_8c_aa706a2634d39e1b59182ab9a9403931c}} 
\index{network.c@{network.c}!neuron\_create@{neuron\_create}}
\index{neuron\_create@{neuron\_create}!network.c@{network.c}}
\doxysubsubsection{\texorpdfstring{neuron\_create()}{neuron\_create()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structneuron__t}{neuron\+\_\+t}} $\ast$ neuron\+\_\+create (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$}]{weights,  }\item[{double}]{bias }\end{DoxyParamCaption})}



Creates a neuron. 


\begin{DoxyParams}{Parameters}
{\em weights} & The weights of the neuron. \\
\hline
{\em bias} & The bias of the neuron. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The instantiated neuron. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{network_8c_source_l00064}{64}} of file \mbox{\hyperlink{network_8c_source}{network.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00065 \{}
\DoxyCodeLine{00066     \mbox{\hyperlink{structneuron__t}{neuron\_t}} *neuron = (\mbox{\hyperlink{structneuron__t}{neuron\_t}} *)malloc(\textcolor{keyword}{sizeof}(\mbox{\hyperlink{structneuron__t}{neuron\_t}}));}
\DoxyCodeLine{00067     \textcolor{keywordflow}{if} (neuron == NULL)}
\DoxyCodeLine{00068         \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{00069     neuron-\/>\mbox{\hyperlink{structneuron__t_a6182effa3a478564d7dcd7f9d856c029}{weights}} = weights;}
\DoxyCodeLine{00070     neuron-\/>\mbox{\hyperlink{structneuron__t_ad82dab1b1a60940e62e80270ad99a522}{bias}} = bias;}
\DoxyCodeLine{00071 }
\DoxyCodeLine{00072     \textcolor{keywordflow}{return} neuron;}
\DoxyCodeLine{00073 \}}

\end{DoxyCode}
\mbox{\Hypertarget{network_8c_a634adde351458c2e8f8825c1816eeb43}\label{network_8c_a634adde351458c2e8f8825c1816eeb43}} 
\index{network.c@{network.c}!neuron\_free@{neuron\_free}}
\index{neuron\_free@{neuron\_free}!network.c@{network.c}}
\doxysubsubsection{\texorpdfstring{neuron\_free()}{neuron\_free()}}
{\footnotesize\ttfamily void neuron\+\_\+free (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structneuron__t}{neuron\+\_\+t}} $\ast$}]{neuron }\end{DoxyParamCaption})}



Frees the allocated neuron. 


\begin{DoxyParams}{Parameters}
{\em neuron} & The neuron to free. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{network_8c_source_l00075}{75}} of file \mbox{\hyperlink{network_8c_source}{network.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00076 \{}
\DoxyCodeLine{00077     \mbox{\hyperlink{matrix_8c_aa20fd2a5c773eda620ce98e2f121b687}{matrix\_free}}(neuron-\/>\mbox{\hyperlink{structneuron__t_a6182effa3a478564d7dcd7f9d856c029}{weights}});}
\DoxyCodeLine{00078     free(neuron);}
\DoxyCodeLine{00079 \}}

\end{DoxyCode}
