\hypertarget{loader_8c}{}\doxysection{src/utils/mnist/loader.c File Reference}
\label{loader_8c}\index{src/utils/mnist/loader.c@{src/utils/mnist/loader.c}}
{\ttfamily \#include $<$err.\+h$>$}\newline
{\ttfamily \#include $<$malloc.\+h$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$stdlib.\+h$>$}\newline
{\ttfamily \#include $<$string.\+h$>$}\newline
{\ttfamily \#include \char`\"{}loader.\+h\char`\"{}}\newline
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{loader_8c_a894874fce4252e840e2412fd1dbfa4ea}{OUTPUT\+\_\+\+SIZE}}~10
\item 
\#define \mbox{\hyperlink{loader_8c_abd607f13447d238cfa36348ed8e5d383}{READ\+\_\+\+LENGTH}}~1024
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
size\+\_\+t \mbox{\hyperlink{loader_8c_acb5c9a1b62024f501998a223bcdb4aed}{load\+\_\+mnist}} (const char $\ast$path, \mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$$\ast$$\ast$\+\_\+inputs, \mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$$\ast$$\ast$\+\_\+expected, size\+\_\+t start, size\+\_\+t length, const char $\ast$mode, size\+\_\+t inputsize, size\+\_\+t outputsize)
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{loader_8c_a894874fce4252e840e2412fd1dbfa4ea}\label{loader_8c_a894874fce4252e840e2412fd1dbfa4ea}} 
\index{loader.c@{loader.c}!OUTPUT\_SIZE@{OUTPUT\_SIZE}}
\index{OUTPUT\_SIZE@{OUTPUT\_SIZE}!loader.c@{loader.c}}
\doxysubsubsection{\texorpdfstring{OUTPUT\_SIZE}{OUTPUT\_SIZE}}
{\footnotesize\ttfamily \#define OUTPUT\+\_\+\+SIZE~10}



Definition at line \mbox{\hyperlink{loader_8c_source_l00008}{8}} of file \mbox{\hyperlink{loader_8c_source}{loader.\+c}}.

\mbox{\Hypertarget{loader_8c_abd607f13447d238cfa36348ed8e5d383}\label{loader_8c_abd607f13447d238cfa36348ed8e5d383}} 
\index{loader.c@{loader.c}!READ\_LENGTH@{READ\_LENGTH}}
\index{READ\_LENGTH@{READ\_LENGTH}!loader.c@{loader.c}}
\doxysubsubsection{\texorpdfstring{READ\_LENGTH}{READ\_LENGTH}}
{\footnotesize\ttfamily \#define READ\+\_\+\+LENGTH~1024}



Definition at line \mbox{\hyperlink{loader_8c_source_l00009}{9}} of file \mbox{\hyperlink{loader_8c_source}{loader.\+c}}.



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{loader_8c_acb5c9a1b62024f501998a223bcdb4aed}\label{loader_8c_acb5c9a1b62024f501998a223bcdb4aed}} 
\index{loader.c@{loader.c}!load\_mnist@{load\_mnist}}
\index{load\_mnist@{load\_mnist}!loader.c@{loader.c}}
\doxysubsubsection{\texorpdfstring{load\_mnist()}{load\_mnist()}}
{\footnotesize\ttfamily size\+\_\+t load\+\_\+mnist (\begin{DoxyParamCaption}\item[{const char $\ast$}]{path,  }\item[{\mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$$\ast$$\ast$}]{\+\_\+inputs,  }\item[{\mbox{\hyperlink{structmatrix__t}{matrix\+\_\+t}} $\ast$$\ast$$\ast$}]{\+\_\+expected,  }\item[{size\+\_\+t}]{start,  }\item[{size\+\_\+t}]{length,  }\item[{const char $\ast$}]{mode,  }\item[{size\+\_\+t}]{inputsize,  }\item[{size\+\_\+t}]{outputsize }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{loader_8c_source_l00182}{182}} of file \mbox{\hyperlink{loader_8c_source}{loader.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00185 \{}
\DoxyCodeLine{00186 }
\DoxyCodeLine{00187     \textcolor{keywordflow}{if} (strcmp(mode, \mbox{\hyperlink{loader_8h_a3d8d65e2de4c173a15a05a5d5dda60b8}{CSV\_MODE}}) \&\& strcmp(mode, \mbox{\hyperlink{loader_8h_a399981b4dd18f0e6b9252badf307ce05}{BINARY\_MODE}}))}
\DoxyCodeLine{00188     \{}
\DoxyCodeLine{00189         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00190     \}}
\DoxyCodeLine{00191 }
\DoxyCodeLine{00192     FILE *file = fopen(path, mode);}
\DoxyCodeLine{00193     \textcolor{keywordflow}{if} (file == NULL)}
\DoxyCodeLine{00194         \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00195 }
\DoxyCodeLine{00196     \textcolor{keywordflow}{if} (length == 0)}
\DoxyCodeLine{00197     \{}
\DoxyCodeLine{00198         *\_inputs = NULL;}
\DoxyCodeLine{00199         *\_expected = NULL;}
\DoxyCodeLine{00200         \textcolor{keywordflow}{if} (strcmp(mode, \mbox{\hyperlink{loader_8h_a3d8d65e2de4c173a15a05a5d5dda60b8}{CSV\_MODE}}) == 0)}
\DoxyCodeLine{00201             length = load\_csv\_dynamic(}
\DoxyCodeLine{00202                 file, \_inputs, \_expected, start, inputsize, outputsize);}
\DoxyCodeLine{00203         \textcolor{keywordflow}{else}}
\DoxyCodeLine{00204             length = 0;}
\DoxyCodeLine{00205     \}}
\DoxyCodeLine{00206     \textcolor{keywordflow}{else}}
\DoxyCodeLine{00207     \{}
\DoxyCodeLine{00208         *\_inputs = (\mbox{\hyperlink{structmatrix__t}{matrix\_t}} **)malloc(length * \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structmatrix__t}{matrix\_t}} *));}
\DoxyCodeLine{00209         \textcolor{keywordflow}{if} (*\_inputs == NULL)}
\DoxyCodeLine{00210             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00211         *\_expected = (\mbox{\hyperlink{structmatrix__t}{matrix\_t}} **)malloc(length * \textcolor{keyword}{sizeof}(\mbox{\hyperlink{structmatrix__t}{matrix\_t}} *));}
\DoxyCodeLine{00212         \textcolor{keywordflow}{if} (*\_expected == NULL)}
\DoxyCodeLine{00213             \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{00214         init\_vectors(*\_expected, length, outputsize, 1);}
\DoxyCodeLine{00215         init\_vectors(*\_inputs, length, inputsize, 0);}
\DoxyCodeLine{00216         \textcolor{keywordflow}{if} (strcmp(mode, \mbox{\hyperlink{loader_8h_a3d8d65e2de4c173a15a05a5d5dda60b8}{CSV\_MODE}}) == 0)}
\DoxyCodeLine{00217         \{}
\DoxyCodeLine{00218             length = load\_csv(file, *\_inputs, *\_expected, start, length);}
\DoxyCodeLine{00219         \}}
\DoxyCodeLine{00220         \textcolor{keywordflow}{else}}
\DoxyCodeLine{00221         \{}
\DoxyCodeLine{00222             length = 0;}
\DoxyCodeLine{00223         \}}
\DoxyCodeLine{00224     \}}
\DoxyCodeLine{00225 }
\DoxyCodeLine{00226     fclose(file);}
\DoxyCodeLine{00227     \textcolor{keywordflow}{return} length;}
\DoxyCodeLine{00228 \}}

\end{DoxyCode}
