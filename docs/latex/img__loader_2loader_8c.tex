\hypertarget{img__loader_2loader_8c}{}\doxysection{src/utils/img\+\_\+loader/loader.c File Reference}
\label{img__loader_2loader_8c}\index{src/utils/img\_loader/loader.c@{src/utils/img\_loader/loader.c}}
{\ttfamily \#include $<$SDL2/\+SDL.\+h$>$}\newline
{\ttfamily \#include $<$SDL2/\+SDL\+\_\+image.\+h$>$}\newline
{\ttfamily \#include $<$dirent.\+h$>$}\newline
{\ttfamily \#include $<$err.\+h$>$}\newline
{\ttfamily \#include \char`\"{}../../network/network.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}../../solver/solver.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}../matrices/matrix.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}loader.\+h\char`\"{}}\newline
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
SDL\+\_\+\+Surface $\ast$ \mbox{\hyperlink{img__loader_2loader_8c_aa94630c00e1f24be513946e50ccdb0e4}{load\+\_\+image}} (const char $\ast$path)
\begin{DoxyCompactList}\small\item\em Loads an image into a surface with SDL. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{img__loader_2loader_8c_afb9117756e7a54f8ffcee98327b324c9}{pixel\+\_\+to\+\_\+grayscale}} (Uint32 pixel\+\_\+color, SDL\+\_\+\+Pixel\+Format $\ast$format, double $\ast$values, size\+\_\+t i)
\begin{DoxyCompactList}\small\item\em Convert a pixel into a grayscale value and stores it into a list. \end{DoxyCompactList}\item 
double $\ast$ \mbox{\hyperlink{img__loader_2loader_8c_a5863b570c49c3fcba3c949409defae0e}{surface\+\_\+to\+\_\+grayscale\+\_\+img}} (SDL\+\_\+\+Surface $\ast$surface)
\begin{DoxyCompactList}\small\item\em Convert a surface into grayscale an return all the values of each pixels. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{img__loader_2loader_8c_ab80f33f81b0c0163335770182c60dcda}{convert}} (char $\ast$img\+\_\+path, char $\ast$net\+\_\+path, char $\ast$grid\+\_\+path, int mode)
\begin{DoxyCompactList}\small\item\em Convert images according to the mode. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{img__loader_2loader_8c_ab80f33f81b0c0163335770182c60dcda}\label{img__loader_2loader_8c_ab80f33f81b0c0163335770182c60dcda}} 
\index{loader.c@{loader.c}!convert@{convert}}
\index{convert@{convert}!loader.c@{loader.c}}
\doxysubsubsection{\texorpdfstring{convert()}{convert()}}
{\footnotesize\ttfamily int convert (\begin{DoxyParamCaption}\item[{char $\ast$}]{img\+\_\+path,  }\item[{char $\ast$}]{net\+\_\+path,  }\item[{char $\ast$}]{grid\+\_\+path,  }\item[{int}]{mode }\end{DoxyParamCaption})}



Convert images according to the mode. 


\begin{DoxyParams}{Parameters}
{\em img\+\_\+path} & =\texorpdfstring{$>$}{>} If mode 1 \+: The path of the image \\
\hline
{\em img\+\_\+path} & =\texorpdfstring{$>$}{>} If mode 2 \+: A directory containing all the images \\
\hline
{\em net\+\_\+path} & The path of the trained network \\
\hline
{\em grid\+\_\+path} & =\texorpdfstring{$>$}{>} Only in mode 2 \+: The path to save the grids \\
\hline
{\em mode} & =\texorpdfstring{$>$}{>} If 1 \+: Display the image and give it\textquotesingle{}s label \\
\hline
{\em mode} & =\texorpdfstring{$>$}{>} If 2 \+: Takes a directory of image and convert them into a grid \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 if gone well, error otherwise 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{img__loader_2loader_8c_source_l00197}{197}} of file \mbox{\hyperlink{img__loader_2loader_8c_source}{loader.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00198 \{}
\DoxyCodeLine{00199 }
\DoxyCodeLine{00200     \textcolor{keywordflow}{if} (SDL\_Init(SDL\_INIT\_VIDEO) != 0)}
\DoxyCodeLine{00201         errx(EXIT\_FAILURE, \textcolor{stringliteral}{"{}\%s"{}}, SDL\_GetError());}
\DoxyCodeLine{00202 }
\DoxyCodeLine{00203     \textcolor{keywordflow}{if} (mode == \mbox{\hyperlink{img__loader_2loader_8h_a39336e579575641618c5ba63855d10e0}{SINGLE\_IMAGE}})}
\DoxyCodeLine{00204     \{}
\DoxyCodeLine{00205         \textcolor{keywordflow}{return} convert\_single(img\_path, net\_path);}
\DoxyCodeLine{00206     \}}
\DoxyCodeLine{00207 }
\DoxyCodeLine{00208     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (mode == \mbox{\hyperlink{img__loader_2loader_8h_ac7c0b099ecd758709f31bfb602a7b6de}{MULTI\_IMAGE}})}
\DoxyCodeLine{00209     \{}
\DoxyCodeLine{00210         \textcolor{keywordflow}{return} convert\_multi(img\_path,net\_path,grid\_path);}
\DoxyCodeLine{00211     \}}
\DoxyCodeLine{00212 }
\DoxyCodeLine{00213     errx(1, \textcolor{stringliteral}{"{}Unvalid mode"{}});}
\DoxyCodeLine{00214 \}}

\end{DoxyCode}
\mbox{\Hypertarget{img__loader_2loader_8c_aa94630c00e1f24be513946e50ccdb0e4}\label{img__loader_2loader_8c_aa94630c00e1f24be513946e50ccdb0e4}} 
\index{loader.c@{loader.c}!load\_image@{load\_image}}
\index{load\_image@{load\_image}!loader.c@{loader.c}}
\doxysubsubsection{\texorpdfstring{load\_image()}{load\_image()}}
{\footnotesize\ttfamily SDL\+\_\+\+Surface $\ast$ load\+\_\+image (\begin{DoxyParamCaption}\item[{const char $\ast$}]{path }\end{DoxyParamCaption})}



Loads an image into a surface with SDL. 


\begin{DoxyParams}{Parameters}
{\em path} & The path of the image \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The surface corresponding to the image 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{img__loader_2loader_8c_source_l00010}{10}} of file \mbox{\hyperlink{img__loader_2loader_8c_source}{loader.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00011 \{}
\DoxyCodeLine{00012     SDL\_Surface *temp = IMG\_Load(path);}
\DoxyCodeLine{00013     SDL\_Surface *res}
\DoxyCodeLine{00014         = SDL\_ConvertSurfaceFormat(temp, SDL\_PIXELFORMAT\_RGB888, 0);}
\DoxyCodeLine{00015     SDL\_FreeSurface(temp);}
\DoxyCodeLine{00016     \textcolor{keywordflow}{return} res;}
\DoxyCodeLine{00017 \}}

\end{DoxyCode}
\mbox{\Hypertarget{img__loader_2loader_8c_afb9117756e7a54f8ffcee98327b324c9}\label{img__loader_2loader_8c_afb9117756e7a54f8ffcee98327b324c9}} 
\index{loader.c@{loader.c}!pixel\_to\_grayscale@{pixel\_to\_grayscale}}
\index{pixel\_to\_grayscale@{pixel\_to\_grayscale}!loader.c@{loader.c}}
\doxysubsubsection{\texorpdfstring{pixel\_to\_grayscale()}{pixel\_to\_grayscale()}}
{\footnotesize\ttfamily pixel\+\_\+to\+\_\+grayscale (\begin{DoxyParamCaption}\item[{Uint32}]{pixel\+\_\+color,  }\item[{SDL\+\_\+\+Pixel\+Format $\ast$}]{format,  }\item[{double $\ast$}]{values,  }\item[{size\+\_\+t}]{i }\end{DoxyParamCaption})}



Convert a pixel into a grayscale value and stores it into a list. 


\begin{DoxyParams}{Parameters}
{\em pixel\+\_\+color} & The rgb value of the pixel \\
\hline
{\em format} & The format of the image \\
\hline
{\em values} & The array to stores the pixels \\
\hline
{\em i} & The index of the pixel \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{img__loader_2loader_8c_source_l00018}{18}} of file \mbox{\hyperlink{img__loader_2loader_8c_source}{loader.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00020 \{}
\DoxyCodeLine{00021     Uint8 r, g, b;}
\DoxyCodeLine{00022     SDL\_GetRGB(pixel\_color, format, \&r, \&g, \&b);}
\DoxyCodeLine{00023     Uint8 average = 0.3 * r + 0.59 * g + 0.11 * b;}
\DoxyCodeLine{00024     \textcolor{keywordtype}{double} val = (double)average / 255.0;}
\DoxyCodeLine{00025     values[i] = val <= 0.5 ? 1 -\/ val : 0.0;}
\DoxyCodeLine{00026 \}}

\end{DoxyCode}
\mbox{\Hypertarget{img__loader_2loader_8c_a5863b570c49c3fcba3c949409defae0e}\label{img__loader_2loader_8c_a5863b570c49c3fcba3c949409defae0e}} 
\index{loader.c@{loader.c}!surface\_to\_grayscale\_img@{surface\_to\_grayscale\_img}}
\index{surface\_to\_grayscale\_img@{surface\_to\_grayscale\_img}!loader.c@{loader.c}}
\doxysubsubsection{\texorpdfstring{surface\_to\_grayscale\_img()}{surface\_to\_grayscale\_img()}}
{\footnotesize\ttfamily double $\ast$ surface\+\_\+to\+\_\+grayscale\+\_\+img (\begin{DoxyParamCaption}\item[{SDL\+\_\+\+Surface $\ast$}]{surface }\end{DoxyParamCaption})}



Convert a surface into grayscale an return all the values of each pixels. 


\begin{DoxyParams}{Parameters}
{\em surface} & The image surface \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
An double arrays of the values in grayscale of each pixels 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{img__loader_2loader_8c_source_l00028}{28}} of file \mbox{\hyperlink{img__loader_2loader_8c_source}{loader.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00029 \{}
\DoxyCodeLine{00030     \textcolor{keywordtype}{double} *values = malloc(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}) * 784);}
\DoxyCodeLine{00031     Uint32 *pixels = surface-\/>pixels;}
\DoxyCodeLine{00032     SDL\_PixelFormat *format = surface-\/>format;}
\DoxyCodeLine{00033 }
\DoxyCodeLine{00034     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{size\_t} i = 0; i < 784; i++)}
\DoxyCodeLine{00035     \{}
\DoxyCodeLine{00036         \textcolor{keywordflow}{if} (SDL\_LockSurface(surface) != 0)}
\DoxyCodeLine{00037             errx(EXIT\_FAILURE, \textcolor{stringliteral}{"{}\%s"{}}, SDL\_GetError());}
\DoxyCodeLine{00038         \mbox{\hyperlink{img__loader_2loader_8c_afb9117756e7a54f8ffcee98327b324c9}{pixel\_to\_grayscale}}(pixels[i], format, values, i);}
\DoxyCodeLine{00039         SDL\_UnlockSurface(surface);}
\DoxyCodeLine{00040     \}}
\DoxyCodeLine{00041     \textcolor{keywordflow}{return} values;}
\DoxyCodeLine{00042 \}}

\end{DoxyCode}
